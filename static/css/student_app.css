/* AgentMath Student App CSS */
/* Extracted from student_app.html - 2025-12-27 */
/* Original Revision: 3.23.0 */

/* ============================================ */
/* MAIN STYLES */
/* ============================================ */

        /* AgentMath Header Banner */
        .agentmath-header-banner {
            width: 100%;
            overflow: hidden;
            line-height: 0;
        }
        
        .header-banner-img {
            width: 100%;
            height: auto;
            object-fit: cover;
            max-height: 120px;
        }
        
        @media (max-width: 768px) {
            .header-banner-img {
                max-height: 80px;
            }
        }
        
        /* ==================== MOBILE MENU STYLES ==================== */
        .mobile-menu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            display: block !important; /* Override Tailwind hidden */
        }
        
        .mobile-menu.hidden {
            display: block !important;
            max-height: 0;
        }
        
        .mobile-menu.show {
            max-height: 300px;
        }
        
        .mobile-menu-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 16px;
            color: #374151;
            transition: background-color 0.2s;
        }
        
        .mobile-menu-item:hover, .mobile-menu-item:active {
            background-color: #f3f4f6;
        }
        
        .mobile-menu-btn {
            min-width: 44px;
            min-height: 44px;
        }
        
        /* ==================== COMPACT QUIZ MODE ==================== */
        
        /* Hide main header during quiz */
        body.quiz-active #mainHeader {
            display: none !important;
        }
        
        body.quiz-active #guestBanner {
            display: none !important;
        }
        
        body.quiz-active #badge-widget {
            display: none !important;
        }
        
        /* Compact Quiz Header Bar */
        .compact-quiz-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 10px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .compact-quiz-header .quiz-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .compact-quiz-header .back-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: background 0.2s;
        }
        
        .compact-quiz-header .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .compact-quiz-header .topic-title {
            color: white;
            font-weight: 600;
            font-size: 16px;
        }
        
        .compact-quiz-header .question-badge {
            background: rgba(255,255,255,0.25);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .compact-quiz-header .score-badge {
            background: white;
            color: #667eea;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .compact-quiz-header .streak-badge {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: none;
            animation: pulse-badge 1s infinite;
        }
        
        .compact-quiz-header .streak-badge.visible {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        @keyframes pulse-badge {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        /* ==================== HOT STREAK INDICATOR ==================== */
        .hot-streak-display {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .hot-streak-display.streak-cold {
            background: rgba(255,255,255,0.15);
            color: rgba(255,255,255,0.7);
        }
        
        .hot-streak-display.streak-warming {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            /* No animation - subtle */
        }
        
        .hot-streak-display.streak-hot {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            color: white;
            /* Gentle pulse only */
            animation: streak-pulse 2s ease-in-out infinite;
        }
        
        .hot-streak-display.streak-fire {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            animation: streak-pulse 1.5s ease-in-out infinite;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }
        
        .hot-streak-display.streak-legendary {
            background: linear-gradient(135deg, #dc2626, #9333ea);
            color: white;
            animation: streak-pulse 1s ease-in-out infinite;
            box-shadow: 0 2px 10px rgba(147, 51, 234, 0.4);
        }
        
        @keyframes streak-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        .streak-flame {
            font-size: 16px;
            display: inline-block;
        }
        
        .streak-multiplier {
            background: rgba(0,0,0,0.2);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-left: 4px;
        }
        
        /* ==================== WHO'S ONLINE COUNTER ==================== */
        .online-counter {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 25px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
        }
        
        .online-counter .pulse-dot {
            width: 10px;
            height: 10px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse-online 2s infinite;
        }
        
        @keyframes pulse-online {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }
        
        .online-counter-mini {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: rgba(16, 185, 129, 0.3);
            border-radius: 15px;
            color: white;
            font-weight: 500;
            font-size: 12px;
        }
        
        .online-counter-mini .pulse-dot {
            width: 6px;
            height: 6px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse-online 2s infinite;
        }
        
        /* ==================== SOUND EFFECTS TOGGLE ==================== */
        .sound-toggle {
            position: relative;
            cursor: pointer;
        }
        
        .sound-toggle.muted i {
            opacity: 0.5;
        }
        
        .sound-toggle.muted::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 24px;
            background: white;
            transform: rotate(45deg);
            top: 6px;
            left: 17px;
        }
        
        /* ==================== DAY 2: QUICK PLAY MODE ==================== */
        .quick-play-card {
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            border-radius: 20px;
            padding: 24px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .quick-play-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(245, 158, 11, 0.4);
        }
        
        .quick-play-card::before {
            content: 'âš¡';
            position: absolute;
            font-size: 120px;
            opacity: 0.1;
            right: -20px;
            bottom: -30px;
        }
        
        .quick-play-badge {
            background: rgba(255,255,255,0.25);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .quick-play-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .quick-play-desc {
            opacity: 0.9;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .quick-play-stats {
            display: flex;
            gap: 20px;
            font-size: 13px;
        }
        
        .quick-play-stat {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        /* ==================== DAY 2: WEEKLY CHALLENGE TRACKER ==================== */
        .weekly-challenge-card {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            border-radius: 20px;
            padding: 24px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .weekly-challenge-card::before {
            content: 'ðŸ†';
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            right: -10px;
            top: -20px;
        }
        
        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .challenge-title {
            font-size: 20px;
            font-weight: 700;
        }
        
        .challenge-timer {
            background: rgba(255,255,255,0.2);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .challenge-progress-container {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 3px;
            margin-bottom: 15px;
        }
        
        .challenge-progress-bar {
            height: 20px;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 8px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            color: #92400e;
        }
        
        .challenge-goals {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .challenge-goal {
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            transition: all 0.2s;
        }
        
        .challenge-goal.completed {
            background: rgba(74, 222, 128, 0.3);
            border: 2px solid rgba(74, 222, 128, 0.5);
        }
        
        .challenge-goal-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .challenge-goal-text {
            font-size: 11px;
            opacity: 0.9;
        }
        
        .challenge-goal-points {
            font-size: 13px;
            font-weight: 700;
            color: #fbbf24;
            margin-top: 4px;
        }
        
        /* ==================== DAY 2: ENHANCED LEADERBOARD ==================== */
        .leaderboard-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .leaderboard-title {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .leaderboard-tabs {
            display: flex;
            gap: 8px;
        }
        
        .leaderboard-tab {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: #f3f4f6;
            color: #6b7280;
        }
        
        .leaderboard-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f9fafb;
            border-radius: 12px;
            transition: all 0.2s;
        }
        
        .leaderboard-item:hover {
            background: #f3f4f6;
            transform: translateX(5px);
        }
        
        .leaderboard-item.top-1 {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
        }
        
        .leaderboard-item.top-2 {
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            border: 2px solid #9ca3af;
        }
        
        .leaderboard-item.top-3 {
            background: linear-gradient(135deg, #fed7aa, #fdba74);
            border: 2px solid #ea580c;
        }
        
        .leaderboard-item.is-me {
            background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
            border: 2px solid #8b5cf6;
        }
        
        .leaderboard-rank {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: #6b7280;
            margin-right: 12px;
        }
        
        .leaderboard-rank.gold { color: #f59e0b; font-size: 24px; }
        .leaderboard-rank.silver { color: #6b7280; font-size: 22px; }
        .leaderboard-rank.bronze { color: #ea580c; font-size: 20px; }
        
        .leaderboard-name {
            flex: 1;
            font-weight: 600;
            color: #1f2937;
        }
        
        .leaderboard-score {
            font-weight: 700;
            color: #8b5cf6;
            font-size: 16px;
        }
        
        .leaderboard-change {
            margin-left: 10px;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .leaderboard-change.up {
            background: #d1fae5;
            color: #059669;
        }
        
        .leaderboard-change.down {
            background: #fee2e2;
            color: #dc2626;
        }
        
        /* ==================== SIDEBAR CARDS (Day 2 Redesign) ==================== */
        .sidebar-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.2s;
        }
        
        .sidebar-card:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.12);
        }
        
        .sidebar-card-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .sidebar-card-icon {
            font-size: 24px;
        }
        
        .sidebar-card-title {
            font-weight: 700;
            font-size: 14px;
            color: #1f2937;
        }
        
        .sidebar-card-content {
            flex: 1;
        }
        
        .sidebar-card-desc {
            font-size: 12px;
            color: #6b7280;
        }
        
        .sidebar-card-arrow {
            color: #9ca3af;
            font-size: 12px;
        }
        
        /* Quick Play Mini */
        .quick-play-mini {
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .quick-play-mini:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3);
        }
        
        .quick-play-mini .sidebar-card-title {
            color: white;
            font-size: 16px;
        }
        
        .quick-play-mini .sidebar-card-desc {
            color: rgba(255,255,255,0.9);
        }
        
        .quick-play-mini .sidebar-card-arrow {
            color: rgba(255,255,255,0.8);
        }
        

        /* Smart Quiz Mini - Adaptive Learning */
        .smart-quiz-mini {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .smart-quiz-mini:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }
        
        .smart-quiz-mini .sidebar-card-title {
            color: white;
            font-size: 16px;
        }
        
        .smart-quiz-mini .sidebar-card-desc {
            color: rgba(255,255,255,0.9);
        }
        
        .smart-quiz-mini .sidebar-card-arrow {
            color: rgba(255,255,255,0.8);
        }
        
        .smart-quiz-mini.guest-disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .smart-quiz-mini.guest-disabled:hover {
            transform: none;
            box-shadow: none;
        }
        
        /* Adaptive Quiz Mini - 10-Level Progression */
        .adaptive-quiz-mini {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .adaptive-quiz-mini:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.3);
        }
        
        .adaptive-quiz-mini .sidebar-card-title {
            color: white;
            font-size: 16px;
        }
        
        .adaptive-quiz-mini .sidebar-card-desc {
            color: rgba(255,255,255,0.9);
        }
        
        .adaptive-quiz-mini .sidebar-card-arrow {
            color: rgba(255,255,255,0.8);
        }
        
        .adaptive-quiz-mini.guest-disabled {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .adaptive-quiz-mini.guest-disabled:hover {
            transform: none;
            box-shadow: none;
        }
        
        /* Adaptive Quiz Level Indicator */
        .adaptive-level-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .adaptive-level-bar {
            display: flex;
            gap: 3px;
            margin-left: 8px;
        }
        
        .adaptive-level-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transition: all 0.3s;
        }
        
        .adaptive-level-dot.active {
            background: #fbbf24;
            box-shadow: 0 0 6px rgba(251, 191, 36, 0.6);
        }
        
        .adaptive-level-dot.completed {
            background: #34d399;
        }
        
        /* Level Up/Down Animation */
        .level-change-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 30px 50px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            animation: levelPopIn 0.5s ease forwards;
        }
        
        .level-change-toast.level-up {
            border: 4px solid #10b981;
        }
        
        .level-change-toast.level-down {
            border: 4px solid #f59e0b;
        }
        
        @keyframes levelPopIn {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        @keyframes levelPopOut {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        }
        
        /* Adaptive Topic Card in Modal */
        .adaptive-topic-card {
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }
        
        .adaptive-topic-card:hover {
            border-color: #8b5cf6;
            background: #f5f3ff;
        }
        
        .adaptive-topic-card.selected {
            border-color: #8b5cf6;
            background: #ede9fe;
        }
        
        .adaptive-topic-card .topic-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        .adaptive-topic-card .topic-name {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }
        
        .adaptive-topic-card .topic-questions {
            font-size: 12px;
            color: #6b7280;
        }
        
        .adaptive-topic-card .topic-level {
            font-size: 11px;
            color: #8b5cf6;
            margin-top: 4px;
        }
        
        /* Weekly Challenge Mini */
        .weekly-challenge-mini {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
        }
        
        .weekly-challenge-mini .sidebar-card-title {
            color: white;
        }
        
        .challenge-mini-progress {
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin-bottom: 8px;
            overflow: hidden;
        }
        
        .challenge-mini-bar {
            height: 100%;
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .challenge-mini-status {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .challenge-mini-timer {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .challenge-mini-goals {
            display: flex;
            justify-content: center;
            gap: 12px;
        }
        
        .challenge-mini-goal {
            font-size: 20px;
            opacity: 0.5;
            transition: all 0.2s;
            cursor: help;
        }
        
        .challenge-mini-goal.completed {
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Leaderboard Mini */
        .leaderboard-mini {
            background: white;
        }
        
        .leaderboard-expand-btn {
            margin-left: auto;
            background: #f3f4f6;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #6b7280;
            transition: all 0.2s;
        }
        
        .leaderboard-expand-btn:hover {
            background: #e5e7eb;
        }
        
        .leaderboard-expand-btn.expanded i {
            transform: rotate(180deg);
        }
        
        .leaderboard-tabs-mini {
            display: flex;
            gap: 4px;
            margin-bottom: 12px;
        }
        
        .lb-tab-mini {
            flex: 1;
            padding: 6px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            background: #f3f4f6;
            color: #6b7280;
            transition: all 0.2s;
        }
        
        .lb-tab-mini.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .leaderboard-mini-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .lb-mini-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            background: #f9fafb;
            border-radius: 8px;
            font-size: 12px;
        }
        
        .lb-mini-item.top-1 {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
        }
        
        .lb-mini-item.top-2 {
            background: #f3f4f6;
        }
        
        .lb-mini-item.top-3 {
            background: linear-gradient(135deg, #fed7aa, #fdba74);
        }
        
        .lb-mini-item.is-me {
            background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
        }
        
        .lb-mini-rank {
            width: 20px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .lb-mini-rank.gold { color: #f59e0b; }
        .lb-mini-rank.silver { color: #6b7280; }
        .lb-mini-rank.bronze { color: #ea580c; }
        
        .lb-mini-name {
            flex: 1;
            font-weight: 600;
            color: #374151;
            margin-left: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .lb-mini-score {
            font-weight: 700;
            color: #8b5cf6;
        }
        
        .leaderboard-expanded-list {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #e5e7eb;
        }
        
        .leaderboard-expanded-list.hidden {
            display: none;
        }
        
        .lb-mini-divider {
            text-align: center;
            color: #9ca3af;
            font-size: 12px;
            padding: 4px 0;
        }
        
        /* ==================== ADDITIONAL RESOURCES PANEL ==================== */
        .resources-panel {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
        }
        
        .resources-panel .sidebar-card-header {
            background: transparent;
            padding-bottom: 8px;
            border-bottom: 1px solid #bae6fd;
            margin-bottom: 10px;
        }
        
        .resources-panel .sidebar-card-icon {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .resources-panel .sidebar-card-title {
            color: #0369a1;
            font-weight: 600;
        }
        
        .resources-buttons-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .resource-category {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .resource-category-header {
            font-size: 12px;
            font-weight: 600;
            color: #0369a1;
            padding: 4px 8px;
            background: rgba(14, 165, 233, 0.1);
            border-radius: 6px;
            margin-bottom: 2px;
        }
        
        .resource-category-items {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding-left: 4px;
        }
        
        .resource-btn-wrapper {
            position: relative;
        }
        
        .resource-btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 10px 14px;
            background: white;
            border: 1px solid #e0e7ff;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            color: #1e40af;
            font-weight: 500;
            font-size: 14px;
        }
        
        .resource-btn:hover {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border-color: transparent;
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .resource-btn i {
            font-size: 12px;
            opacity: 0.7;
            transition: transform 0.2s;
        }
        
        .resource-btn:hover i {
            opacity: 1;
            transform: translateX(4px);
        }
        
        /* Resource Popup on Hover */
        .resource-popup {
            position: absolute;
            right: calc(100% + 15px);
            top: 50%;
            transform: translateY(-50%);
            width: 510px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            pointer-events: none;
        }
        
        .resource-btn-wrapper:hover .resource-popup {
            opacity: 1;
            visibility: visible;
            right: calc(100% + 20px);
        }
        
        .resource-popup::after {
            content: '';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            border: 8px solid transparent;
            border-left-color: white;
        }
        
        .resource-popup-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 12px 12px 0 0;
            color: white;
        }
        
        .resource-popup-header h4 {
            font-weight: 600;
            font-size: 17px;
            margin: 0 0 6px 0;
        }
        
        .resource-popup-header p {
            font-size: 14px;
            opacity: 0.9;
            margin: 0;
            line-height: 1.4;
        }
        
        .resource-popup-image {
            padding: 16px;
            background: #f8fafc;
            border-radius: 0 0 12px 12px;
        }
        
        .resource-popup-image img {
            width: 100%;
            height: auto;
            max-height: 420px;
            object-fit: cover;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .resource-popup-footer {
            padding: 10px 16px;
            background: #f1f5f9;
            border-radius: 0 0 12px 12px;
            text-align: center;
        }
        
        .resource-popup-footer span {
            font-size: 12px;
            color: #64748b;
        }
        
        /* Mobile: Show popup below instead of left */
        @media (max-width: 1023px) {
            .resource-popup {
                position: fixed;
                right: 50% !important;
                left: auto;
                top: 50%;
                transform: translate(50%, -50%);
                width: 90%;
                max-width: 540px;
            }
            
            .resource-btn-wrapper:hover .resource-popup {
                right: 50% !important;
            }
            
            .resource-popup::after {
                display: none;
            }
        }
        
        /* Prevent floating elements from causing horizontal scroll */
        html, body {
            overflow-x: hidden;
            max-width: 100vw;
        }
        
        /* Ensure main content isn't affected by fixed positioned elements */
        .main-layout,
        .topics-column,
        .sidebar-column,
        .adaptive-quiz-container {
            max-width: 100%;
            box-sizing: border-box;
        }
        
        /* ==================== MOBILE LAYOUT REORDER ==================== */
        @media (max-width: 1023px) {
            .main-layout {
                display: flex;
                flex-direction: column;
            }
            /* On mobile, we need stats first, then topics, then other sidebar items */
            .main-layout .topics-column {
                order: 2;
            }
            .main-layout .sidebar-column {
                order: 1; /* This won't work as we need to split sidebar items */
                display: contents; /* Allow children to participate in parent flex */
            }
            .stats-card {
                order: 1 !important;
            }
            .resources-panel {
                order: 2 !important;
            }
            .smart-quiz-mini {
                order: 3 !important;
            }
            .adaptive-quiz-mini {
                order: 4 !important;
            }
            .quick-play-mini {
                order: 5 !important;
            }
            .weekly-challenge-mini {
                order: 6 !important;
            }
            .leaderboard-mini {
                order: 7 !important;
            }
            .topics-column {
                order: 2 !important;
            }
            /* Add margin since display:contents removes the container spacing */
            .sidebar-column > * {
                margin-bottom: 1rem;
            }
        }
        
        /* ==================== COMPACT ACTION BUTTONS ==================== */
        .action-btn {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        /* ==================== SIDEBAR STATS CARD ==================== */
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stats-card .sidebar-card-header {
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .stats-card .sidebar-card-title {
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        .stat-item {
            text-align: center;
            padding: 8px 4px;
            background: rgba(255,255,255,0.15);
            border-radius: 8px;
        }
        
        .stat-value {
            display: block;
            font-size: 18px;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .stat-label {
            display: block;
            font-size: 10px;
            opacity: 0.9;
            margin-top: 2px;
        }
        
        .recent-badges-mini {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .compact-quiz-header .tools {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .compact-quiz-header .tool-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s;
            position: relative;
        }
        
        .compact-quiz-header .tool-btn:hover {
            background: rgba(255,255,255,0.35);
            transform: scale(1.1);
        }
        
        .compact-quiz-header .tool-btn.active {
            background: white;
            color: #667eea;
        }
        
        .compact-quiz-header .tool-btn.hint-btn {
            background: rgba(251, 191, 36, 0.3);
        }
        
        .compact-quiz-header .tool-btn.hint-btn:hover {
            background: rgba(251, 191, 36, 0.5);
        }
        
        .compact-quiz-header .tool-btn.hint-used {
            background: rgba(251, 191, 36, 0.8);
            color: #92400e;
        }
        
        /* Compact Progress Bar */
        .compact-progress {
            height: 4px;
            background: rgba(255,255,255,0.3);
            width: 100%;
        }
        
        .compact-progress-fill {
            height: 100%;
            background: white;
            transition: width 0.3s ease;
        }
        
        /* Inline Feedback + Next Button */
        .feedback-next-row {
            display: flex;
            align-items: stretch;
            gap: 12px;
            margin-top: 16px;
        }
        
        .feedback-inline {
            flex: 1;
            padding: 12px 16px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .feedback-inline.correct {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border: 2px solid #10b981;
        }
        
        .feedback-inline.incorrect {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 2px solid #3b82f6;
        }
        
        .feedback-inline .feedback-icon {
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .feedback-inline .feedback-text {
            flex: 1;
            font-weight: 600;
            font-size: 15px;
        }
        
        .feedback-inline .feedback-text.correct {
            color: #065f46;
        }
        
        .feedback-inline .feedback-text.incorrect {
            color: #1e40af;
        }
        
        .feedback-inline .streak-bonus {
            font-size: 12px;
            color: #ea580c;
            font-weight: 600;
        }
        
        .next-btn-inline {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .next-btn-inline:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }
        
        /* Explanation Section (collapsible) */
        .explanation-section {
            margin-top: 12px;
            padding: 12px 16px;
            background: #f8fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .explanation-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            color: #64748b;
            font-size: 14px;
        }
        
        .explanation-content {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e2e8f0;
            color: #475569;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* ==================== ADAPTIVE HELP MODAL ==================== */
        .adaptive-help-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        
        /* Help button pulse animation for Level 1 */
        @keyframes helpPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4); }
            50% { transform: scale(1.08); box-shadow: 0 4px 20px rgba(251, 191, 36, 0.8); }
        }
        
        .help-btn-pulse {
            animation: helpPulse 1.5s ease-in-out infinite;
        }
        
        .adaptive-help-modal.show {
            display: flex;
        }
        
        .adaptive-help-content {
            background: white;
            border-radius: 20px;
            max-width: 700px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .adaptive-help-header {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            padding: 20px 25px;
            border-radius: 20px 20px 0 0;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        
        .adaptive-help-header h2 {
            margin: 0 0 5px 0;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .adaptive-help-header .level-badge {
            background: rgba(255, 255, 255, 0.25);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .adaptive-help-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        
        .adaptive-help-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .adaptive-help-body {
            padding: 25px;
        }
        
        .help-section {
            margin-bottom: 25px;
        }
        
        .help-section h3 {
            color: #8b5cf6;
            font-size: 1.1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .help-section p {
            color: #4b5563;
            line-height: 1.7;
            margin-bottom: 10px;
        }
        
        .worked-example {
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            border-radius: 12px;
            padding: 18px;
            margin: 15px 0;
            border-left: 4px solid #8b5cf6;
        }
        
        .worked-example .example-question {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 12px;
            font-size: 1rem;
        }
        
        .worked-example .example-visual {
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .worked-example .step {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 10px 0;
            color: #374151;
        }
        
        .worked-example .step-number {
            background: #8b5cf6;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .worked-example .answer {
            background: #dcfce7;
            color: #166534;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .help-tip {
            background: #fef3c7;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        
        .help-tip-icon {
            font-size: 1.5rem;
        }
        
        .help-tip-text {
            color: #92400e;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .help-got-it-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.2s;
        }
        
        .help-got-it-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4);
        }
        
        @media (max-width: 640px) {
            .adaptive-help-content {
                max-height: 90vh;
                border-radius: 16px;
            }
            
            .adaptive-help-header {
                padding: 15px 20px;
                border-radius: 16px 16px 0 0;
            }
            
            .adaptive-help-body {
                padding: 20px;
            }
        }
        
        /* ==================== FLOATING CALCULATOR ==================== */
        .calculator-toggle-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 12px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .calculator-toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .calculator-toggle-btn.active {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
        
        /* Floating Calculator Overlay - Now transparent to allow interaction */
        .calculator-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            pointer-events: none; /* Allow clicks through to content behind */
        }
        
        .calculator-overlay.visible {
            display: block;
        }
        
        .calculator-container {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 2px solid #e0e7ff;
            max-width: 320px;
            width: 320px;
            animation: calcSlideIn 0.3s ease-out;
            pointer-events: auto; /* Calculator itself is clickable */
            cursor: default;
        }
        
        @keyframes calcSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .calculator-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move; /* Show drag cursor */
            user-select: none; /* Prevent text selection while dragging */
        }
        
        .calculator-header h4 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            pointer-events: none; /* Let drag events pass through to header */
        }
        
        .calculator-header .drag-hint {
            font-size: 10px;
            opacity: 0.7;
            font-weight: normal;
            margin-left: 8px;
        }
        
        .calculator-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .calculator-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .calculator-display {
            background: #1e1e2e;
            padding: 16px;
            text-align: right;
        }
        
        .calc-expression {
            color: #888;
            font-size: 14px;
            min-height: 20px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }
        
        .calc-result {
            color: white;
            font-size: 32px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            min-height: 40px;
            word-break: break-all;
        }
        
        .calculator-body {
            padding: 12px;
            background: #f8fafc;
        }
        
        .calc-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .calc-row:last-child {
            margin-bottom: 0;
        }
        
        .calc-btn {
            padding: 14px 8px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calc-btn:active {
            transform: scale(0.95);
        }
        
        .calc-btn-number {
            background: white;
            color: #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .calc-btn-number:hover {
            background: #f0f0f0;
        }
        
        .calc-btn-operator {
            background: #667eea;
            color: white;
        }
        
        .calc-btn-operator:hover {
            background: #5a6fd6;
        }
        
        .calc-btn-function {
            background: #e0e7ff;
            color: #667eea;
        }
        
        .calc-btn-function:hover {
            background: #c7d2fe;
        }
        
        .calc-btn-clear {
            background: #ef4444;
            color: white;
        }
        
        .calc-btn-clear:hover {
            background: #dc2626;
        }
        
        .calc-btn-equals {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .calc-btn-equals:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }
        
        .calculator-footer {
            padding: 12px 16px;
            background: #f0f4ff;
            border-top: 1px solid #e0e7ff;
        }
        
        .calc-session-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
        }
        
        .calc-session-toggle input {
            width: 18px;
            height: 18px;
            accent-color: #667eea;
        }
        
        /* Remove old calculator wrapper styles for desktop side-panel */
        .calculator-wrapper {
            display: none;
        }
        
        .quiz-content-wrapper {
            display: block;
        }
        
        .quiz-main-content {
            width: 100%;
        }
        
        /* Mobile adjustments */
        @media (max-width: 768px) {
            .compact-quiz-header {
                padding: 8px 12px;
            }
            
            .compact-quiz-header .topic-title {
                font-size: 14px;
            }
            
            .compact-quiz-header .question-badge,
            .compact-quiz-header .score-badge {
                font-size: 12px;
                padding: 3px 8px;
            }
            
            .compact-quiz-header .tool-btn {
                width: 32px;
                height: 32px;
                font-size: 14px;
            }
            
            .feedback-next-row {
                flex-direction: column;
            }
            
            .next-btn-inline {
                width: 100%;
                text-align: center;
            }
            
            .calc-btn {
                padding: 12px 6px;
                font-size: 16px;
            }
            
            .calc-result {
                font-size: 28px;
            }
        }
        
        /* ==================== BONUS QUESTION STYLES ==================== */
        .bonus-question-unlock {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 3px solid #f59e0b;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            animation: bonus-pulse 2s ease-in-out infinite;
        }
        
        @keyframes bonus-pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 20px 10px rgba(245, 158, 11, 0.2); }
        }
        
        .bonus-question-unlock h3 {
            color: #92400e;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .bonus-question-unlock p {
            color: #78350f;
            margin-bottom: 16px;
        }
        
        .bonus-question-unlock .bonus-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .bonus-question-unlock .try-btn {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .bonus-question-unlock .try-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22, 163, 74, 0.4);
        }
        
        .bonus-question-unlock .skip-btn {
            background: #e5e7eb;
            color: #4b5563;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bonus-question-unlock .skip-btn:hover {
            background: #d1d5db;
        }
        
        /* Bonus Question Modal */
        .bonus-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .bonus-modal-overlay.visible {
            display: flex;
        }
        
        .bonus-modal {
            background: white;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .bonus-modal-header {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 20px 20px 0 0;
        }
        
        .bonus-modal-header h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .bonus-modal-header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .bonus-modal-body {
            padding: 24px;
        }
        
        .bonus-image-container {
            width: 100%;
            aspect-ratio: 16/10;
            background: #1f2937;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .bonus-image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .bonus-image-container .loading {
            color: #9ca3af;
            font-size: 14px;
        }
        
        .bonus-question-text {
            text-align: center;
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 20px;
        }
        
        .bonus-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        @media (max-width: 500px) {
            .bonus-options {
                grid-template-columns: 1fr;
            }
        }
        
        .bonus-option-btn {
            background: #f3f4f6;
            border: 2px solid #e5e7eb;
            padding: 14px 16px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }
        
        .bonus-option-btn:hover:not(:disabled) {
            background: #e0f2fe;
            border-color: #3b82f6;
            color: #1e40af;
        }
        
        .bonus-option-btn.correct {
            background: #dcfce7;
            border-color: #16a34a;
            color: #166534;
        }
        
        .bonus-option-btn.incorrect {
            background: #fee2e2;
            border-color: #dc2626;
            color: #991b1b;
        }
        
        .bonus-option-btn.reveal-correct {
            background: #dcfce7;
            border-color: #16a34a;
            color: #166534;
        }
        
        .bonus-option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }
        
        /* Bonus Result */
        .bonus-result {
            margin-top: 20px;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
        }
        
        .bonus-result.correct {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border: 2px solid #16a34a;
        }
        
        .bonus-result.incorrect {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border: 2px solid #3b82f6;
        }
        
        .bonus-result h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .bonus-result.correct h3 {
            color: #166534;
        }
        
        .bonus-result.incorrect h3 {
            color: #1e40af;
        }
        
        .bonus-result .points-earned {
            font-size: 32px;
            font-weight: 800;
            color: #16a34a;
            margin: 10px 0;
        }
        
        .bonus-result .fun-fact {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-top: 12px;
            text-align: left;
        }
        
        .bonus-result .fun-fact-label {
            font-weight: 600;
            color: #f59e0b;
            font-size: 12px;
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        
        .bonus-result .fun-fact-text {
            color: #4b5563;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .bonus-modal-footer {
            padding: 16px 24px 24px;
            text-align: center;
        }
        
        .bonus-close-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bonus-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        /* ==================== DINO ARCHIVE MODAL ==================== */
        .dino-archive-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-y: auto;
        }
        
        .dino-archive-overlay.visible {
            display: flex;
        }
        
        .dino-archive-modal {
            background: white;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            margin: 20px auto;
            animation: modalSlideIn 0.3s ease-out;
        }
        
        .dino-archive-header {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 20px 20px 0 0;
            position: relative;
        }
        
        .dino-archive-header h2 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .dino-archive-header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .dino-archive-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .dino-archive-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .dino-archive-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            margin-top: 15px;
            border-radius: 10px;
        }
        
        .dino-archive-stat {
            text-align: center;
        }
        
        .dino-archive-stat-value {
            font-size: 28px;
            font-weight: bold;
        }
        
        .dino-archive-stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .dino-archive-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .dino-archive-empty {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        
        .dino-archive-empty i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .dino-archive-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .dino-archive-card {
            background: #f9fafb;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
        }
        
        .dino-archive-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .dino-archive-card.correct {
            border-color: #22c55e;
            background: #f0fdf4;
        }
        
        .dino-archive-card.incorrect {
            border-color: #ef4444;
            background: #fef2f2;
        }
        
        .dino-archive-card-image-wrapper {
            width: 100%;
            height: 150px;
            background: linear-gradient(135deg, #1e1b4b, #312e81);
            overflow: hidden;
        }
        
        .dino-archive-card-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            background: #e5e7eb;
        }
        
        .dino-placeholder {
            width: 100%;
            height: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1e1b4b, #312e81);
            color: white;
        }
        
        .dino-placeholder span {
            font-size: 48px;
            margin-bottom: 8px;
        }
        
        .dino-placeholder small {
            font-size: 12px;
            opacity: 0.8;
            text-align: center;
            padding: 0 10px;
        }
        
        .dino-archive-card-body {
            padding: 12px;
        }
        
        .dino-archive-card-answer {
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .dino-archive-card.correct .dino-archive-card-answer {
            color: #16a34a;
        }
        
        .dino-archive-card.incorrect .dino-archive-card-answer {
            color: #dc2626;
        }
        
        .dino-archive-card-meta {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .dino-archive-card-fact {
            font-size: 13px;
            color: #4b5563;
            line-height: 1.4;
            background: white;
            padding: 8px;
            border-radius: 6px;
            border-left: 3px solid #f59e0b;
        }
        
        .dino-archive-card-your-answer {
            font-size: 12px;
            color: #dc2626;
            margin-top: 6px;
            font-style: italic;
        }
        
        .dino-archive-footer {
            padding: 15px 20px;
            text-align: center;
            border-top: 1px solid #e5e7eb;
        }
        
        /* WHO AM I: Ensure container fits nicely in side-by-side layout */
        @media (min-width: 1024px) {
            #who-am-i-container {
                position: sticky;
                top: 20px;
                max-height: calc(100vh - 150px);
                overflow-y: auto;
            }
        }
        
        /* Adaptive Quiz Who Am I: Smaller grid for side-by-side */
        #adaptive-who-am-i-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 15px;
        }
        
        #adaptive-who-am-i-container .who-am-i-wrapper {
            max-width: 100%;
        }
        
        #adaptive-who-am-i-container .who-am-i-header h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        #adaptive-who-am-i-container .who-am-i-header p {
            font-size: 0.8rem;
        }
        
        #adaptive-who-am-i-container .reveal-grid {
            max-width: 280px;
            min-height: 150px;
        }
        
        #adaptive-who-am-i-container .reveal-tile span {
            font-size: 11px;
        }
        
        #adaptive-who-am-i-container .guess-button {
            padding: 8px 16px;
            font-size: 0.85rem;
        }
        
        #adaptive-who-am-i-container .who-am-i-progress {
            font-size: 0.8rem;
        }
        
        #adaptive-who-am-i-container .who-am-i-hint {
            font-size: 0.85rem;
            padding: 8px 12px;
        }
        
        /* Mobile: Stack vertically */
        @media (max-width: 768px) {
            .adaptive-main-content {
                flex-direction: column !important;
            }
            
            #adaptive-who-am-i-container {
                flex: 1 1 100% !important;
                max-width: 100% !important;
                order: 3 !important;
                margin-top: 20px;
            }
            
            #adaptive-who-am-i-container .reveal-grid {
                max-width: 300px;
            }
        }
        
        .number-line-container {
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .number-line {
            position: relative;
            margin: 30px 20px;
            height: 80px;
        }

        .number-line-base {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: #4a5568;
            transform: translateY(-50%);
        }

        .number-line-tick {
            position: absolute;
            top: 50%;
            width: 2px;
            height: 20px;
            background: #4a5568;
            transform: translate(-50%, -50%);
        }

        .number-line-label {
            position: absolute;
            top: 70%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: bold;
            color: #2d3748;
        }

        .number-line-arc {
            position: absolute;
            top: 15%;
            border: 3px solid #667eea;
            border-bottom: none;
            border-radius: 50px 50px 0 0;
            height: 25px;
        }

        .number-line-arrow {
            position: absolute;
            font-size: 24px;
            color: #667eea;
            animation: bounce 0.8s infinite;
        }

        .number-line-start-dot {
            position: absolute;
            top: 50%;
            width: 12px;
            height: 12px;
            background: #48bb78;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .number-line-end-dot {
            position: absolute;
            top: 50%;
            width: 16px;
            height: 16px;
            background: #f56565;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            border: 3px solid white;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            z-index: 10;
            animation: pulse 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes teamPlayGlow {
            0%, 100% { opacity: 0.3; transform: translate(0, 0) rotate(0deg); }
            50% { opacity: 0.6; transform: translate(-10%, 10%) rotate(5deg); }
        }

        /* Badge Widget Styles */
        .badge-summary-widget {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            margin: 20px auto 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 1200px;
        }

        .badge-summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .badge-summary-title {
            font-size: 1.8em;
            font-weight: bold;
            margin: 0;
        }

        .view-badges-btn {
            background: white;
            color: #667eea;
            padding: 10px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .view-badges-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }

        .badge-summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .badge-stat-box {
            text-align: center;
            background: rgba(255,255,255,0.2);
            padding: 20px 15px;
            border-radius: 12px;
            transition: all 0.3s;
            /* backdrop-filter: blur(10px); */ /* REMOVED */
        }

        .badge-stat-box:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-3px);
        }

        .badge-stat-value {
            font-size: 2.2em;
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
        }

        .badge-stat-label {
            font-size: 0.9em;
            opacity: 0.95;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .recent-badge-mini {
            display: inline-block;
            background: rgba(255,255,255,0.25);
            padding: 8px 16px;
            border-radius: 20px;
            margin: 5px;
            font-size: 0.9em;
            /* backdrop-filter: blur(5px); */ /* REMOVED */
        }

        .badge-widget-loading {
            text-align: center;
            padding: 20px;
            opacity: 0.8;
        }

        @media (max-width: 640px) {
            .badge-summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            .badge-summary-title {
                font-size: 1.4em;
            }
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        .number-line-instruction {
            text-align: center;
            color: #4a5568;
            font-size: 14px;
            margin-top: 10px;
            font-weight: 500;
        }

        /* ============ Mastery Indicator Styles ============ */
        .mastery-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            padding: 8px 12px;
            border-radius: 50%;
            font-size: 28px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.6);
            animation: shine 2s infinite;
            z-index: 10;
            line-height: 1;
        }

        .difficulty-mastery {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            z-index: 10;
            line-height: 1.2;
        }

        .difficulty-mastery .trophy {
            font-size: 20px;
        }

        .difficulty-mastery .score {
            font-size: 10px;
            letter-spacing: 0.3px;
            font-weight: 700;
        }

        /* Mastered difficulty button - dimmed appearance */
        .difficulty-button.mastered {
            opacity: 0.65;
            filter: saturate(0.5);
            position: relative;
        }

        .difficulty-button.mastered::after {
            content: 'âœ“';
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            color: #22c55e;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .difficulty-button.mastered:hover {
            opacity: 0.85;
            filter: saturate(0.7);
        }

        @keyframes shine {
            0%, 100% {
                box-shadow: 0 4px 15px rgba(255, 215, 0, 0.6);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 6px 25px rgba(255, 215, 0, 0.9);
                transform: scale(1.05);
            }
        }

        .topic-card, .difficulty-button {
            position: relative;
        }

        /* Learning Path Styles */
        .learning-path-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            overflow: visible;
            z-index: 1;
        }
        
        /* CRITICAL: Raise strand z-index when any topic card inside is hovered */
        .learning-path-card:has(.unified-topic-card:hover) {
            z-index: 1000;
        }

        .learning-path-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(255,255,255,0.1) 0%, transparent 50%);
            border-radius: 24px;
            pointer-events: none;
        }

        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .path-header {
            text-align: center;
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .path-number {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 12px;
        }

        .path-title {
            color: white;
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .path-description {
            color: rgba(255,255,255,0.9);
            font-size: 16px;
        }

        .path-flow {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            flex-wrap: wrap;
            gap: 20px;
            row-gap: 28px;
            position: relative;
            z-index: 1;
            overflow: visible;
            margin-bottom: 20px;
        }

        /* ========================================
           COLLAPSIBLE STRAND STYLES
           ======================================== */
        
        /* Override learning-path-card for collapsible design */
        .learning-path-card {
            background: white !important;
            padding: 0 !important;
            border-radius: 16px !important;
        }
        
        .learning-path-card::before {
            display: none;
        }

        /* Collapsible Header - Always Visible */
        .strand-collapse-header {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            cursor: pointer;
            user-select: none;
            transition: background 0.2s ease;
            border-bottom: 1px solid transparent;
            border-radius: 16px;
        }

        .strand-collapse-header:hover {
            background: #f8fafc;
        }

        .learning-path-card.expanded .strand-collapse-header {
            border-bottom: 1px solid #e5e7eb;
            border-radius: 16px 16px 0 0;
        }

        .strand-chevron {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: #64748b;
            background: #f1f5f9;
            border-radius: 8px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .learning-path-card.expanded .strand-chevron {
            transform: rotate(90deg);
            background: #e0e7ff;
            color: #4f46e5;
        }

        .strand-header-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 14px;
            min-width: 0;
        }

        .strand-header-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
            flex-shrink: 0;
        }

        .strand-header-text {
            min-width: 0;
        }

        .strand-header-text h3 {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
            margin: 0 0 2px 0;
        }

        .strand-header-text p {
            font-size: 13px;
            color: #64748b;
            margin: 0;
        }

        .strand-header-progress {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-shrink: 0;
        }

        .strand-progress-ring {
            width: 48px;
            height: 48px;
            position: relative;
        }

        .strand-progress-ring svg {
            transform: rotate(-90deg);
        }

        .strand-progress-ring .bg {
            fill: none;
            stroke: #e5e7eb;
            stroke-width: 4;
        }

        .strand-progress-ring .progress {
            fill: none;
            stroke-width: 4;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .strand-progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            font-weight: 700;
            color: #374151;
        }

        .strand-stats {
            text-align: right;
        }

        .strand-stats-main {
            font-size: 15px;
            font-weight: 700;
            color: #1e293b;
        }

        .strand-stats-sub {
            font-size: 12px;
            color: #64748b;
        }

        /* Collapsible Content */
        .strand-collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, overflow 0s 0.4s;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 0 0 16px 16px;
        }

        /* CRITICAL: When expanded, overflow must be VISIBLE for popups */
        .learning-path-card.expanded .strand-collapsible-content {
            max-height: 5000px;
            overflow: visible;
            transition: max-height 0.4s ease, overflow 0s 0s;
        }

        /* Path header inside collapsible - simplified */
        .learning-path-card .path-header {
            text-align: left;
            margin-bottom: 16px;
            padding: 16px 20px 0 20px;
        }

        .learning-path-card .path-number {
            display: inline-block;
            background: rgba(255,255,255,0.3);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
        }

        .learning-path-card .path-title,
        .learning-path-card .path-description {
            display: none;
        }

        /* Path flow inside collapsible */
        .learning-path-card .path-flow {
            padding: 0 20px 20px 20px;
        }

        /* Revision section styling inside collapsible */
        .learning-path-card .revision-divider {
            padding: 0 20px;
        }

        /* Hide progress on mobile */
        @media (max-width: 768px) {
            .strand-header-progress {
                display: none;
            }
            
            .strand-collapse-header {
                padding: 14px 16px;
            }
            
            .strand-header-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .strand-header-text h3 {
                font-size: 16px;
            }
        }

        /* ======================================== */
        
        /* Flow arrows between cards */
        .unified-flow-arrow {
            color: white;
            font-size: 28px;
            opacity: 0.6;
            margin: 0 4px;
        }

        .flow-topic-card {
            background: white;
            border-radius: 16px;
            padding: 24px 20px;
            min-width: 140px;
            max-width: 160px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            border: 3px solid transparent;
        }

        .flow-topic-card:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
            border-color: #667eea;
        }

        .flow-topic-card.mastered {
            border-color: #48bb78;
            background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
            opacity: 0.7;
            filter: saturate(0.6);
        }

        .flow-topic-card.mastered:hover {
            opacity: 0.9;
            filter: saturate(0.8);
        }

        .flow-topic-card.mastered .icon {
            opacity: 0.7;
        }

        .flow-topic-card .icon {
            font-size: 48px;
            margin-bottom: 12px;
            display: block;
        }

        .flow-topic-card .title {
            font-size: 15px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .flow-topic-card .mastery-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.6);
            animation: trophyPulse 2s infinite;
            border: 2px solid white;
        }

        @keyframes trophyPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 4px 12px rgba(255, 215, 0, 0.6); }
            50% { transform: scale(1.1); box-shadow: 0 6px 16px rgba(255, 215, 0, 0.8); }
        }

        .flow-arrow {
            color: white;
            font-size: 32px;
            opacity: 0.6;
            animation: arrowFloat 2s ease-in-out infinite;
        }

        @keyframes arrowFloat {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(8px); }
        }

        .flow-topic-card .progress-ring {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            color: #667eea;
            font-weight: 600;
        }

        /* Difficulty progress dots on topic cards */
        .difficulty-progress {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 8px;
        }

        .difficulty-progress .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #e2e8f0;
            border: 2px solid #cbd5e0;
            transition: all 0.3s;
        }

        .difficulty-progress .dot.completed {
            background: linear-gradient(135deg, #48bb78, #38a169);
            border-color: #2f855a;
            box-shadow: 0 2px 4px rgba(72, 187, 120, 0.4);
        }

        .difficulty-progress .dot:nth-child(1).completed { background: linear-gradient(135deg, #48bb78, #38a169); }
        .difficulty-progress .dot:nth-child(2).completed { background: linear-gradient(135deg, #ecc94b, #d69e2e); }
        .difficulty-progress .dot:nth-child(3).completed { background: linear-gradient(135deg, #f56565, #e53e3e); }

        /* Responsive adjustments for older flow layout */
        @media (max-width: 768px) {
            .flow-arrow {
                transform: rotate(90deg);
            }

            .flow-topic-card {
                width: 100%;
                max-width: 280px;
            }
        }

        .best-score-display {
            margin-top: 8px;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
        }

        /* ==================== UNIFIED TOPIC CARDS ==================== */
        .unified-topic-card {
            background: white;
            border-radius: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: visible;
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
            width: 220px;
            min-width: 220px;
            max-width: 220px;
            height: 300px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        /* CRITICAL: Raise z-index on hover so popup appears above other cards */
        .unified-topic-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            border-color: var(--topic-color, #6b7280);
            z-index: 100;
        }
        
        .unified-topic-card.all-mastered {
            border-color: #10b981;
        }
        
        /* JC Exam Level Popup */
        .jc-level-popup {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.35);
            border: 2px solid #f59e0b;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
            pointer-events: none;
        }
        
        /* Inner content wrapper */
        .jc-popup-content {
            background: #ffffff;
            border-radius: 10px;
            overflow: hidden;
        }
        
        /* Default: popup appears BELOW */
        .jc-level-popup {
            top: calc(100% + 8px);
        }
        
        /* Arrow pointing UP by default */
        .jc-level-popup .jc-popup-arrow {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 10px solid #f59e0b;
        }
        
        /* When popup needs to appear ABOVE (added via JS) */
        /* When popup needs to appear ABOVE */
        .jc-level-popup.position-above {
            top: auto;
            bottom: calc(100% + 8px);
        }
        
        .jc-level-popup.position-above .jc-popup-arrow {
            top: auto;
            bottom: -10px;
            border-bottom: none;
            border-top: 10px solid #f59e0b;
        }
        
        /* Show popup on card hover */
        .unified-topic-card:hover .jc-level-popup {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        .jc-popup-header {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            padding: 14px 16px;
            border-bottom: 2px solid #f59e0b;
        }
        
        .jc-popup-header h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #92400e;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .jc-popup-header p {
            margin: 0;
            font-size: 11px;
            color: #78350f;
            line-height: 1.5;
        }
        
        .jc-curriculum-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: #059669;
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .jc-popup-levels {
            padding: 12px 14px;
            background: #ffffff;
        }
        
        .jc-level-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .jc-level-item {
            background: #f9fafb;
            border-radius: 8px;
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #e5e7eb;
        }
        
        .jc-level-item.foundation {
            border-left: 4px solid #10b981;
        }
        
        .jc-level-item.ordinary {
            border-left: 4px solid #3b82f6;
        }
        
        .jc-level-item.higher {
            border-left: 4px solid #8b5cf6;
        }
        
        .jc-level-item.mastery {
            border-left: 4px solid #f59e0b;
        }
        
        /* L2LP NCCA Band Styles */
        .jc-level-item.developing {
            border-left: 4px solid #3b82f6;
        }
        
        .jc-level-item.progressing {
            border-left: 4px solid #8b5cf6;
        }
        
        .jc-level-item.consolidating {
            border-left: 4px solid #f59e0b;
        }
        
        .jc-level-num {
            font-weight: 700;
            font-size: 13px;
            color: #374151;
        }
        
        .jc-level-title {
            font-size: 9px;
            color: #6b7280;
            margin-top: 3px;
            line-height: 1.3;
            min-height: 24px;
        }
        
        .jc-band-legend {
            display: flex;
            justify-content: center;
            gap: 12px;
            padding: 10px 14px;
            background: #f3f4f6;
            border-top: 1px solid #e5e7eb;
        }
        
        .jc-band-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            color: #4b5563;
            font-weight: 500;
        }
        
        .jc-band-dot {
            width: 10px;
            height: 10px;
            border-radius: 3px;
        }
        
        .jc-band-dot.foundation { background: #10b981; }
        .jc-band-dot.ordinary { background: #3b82f6; }
        .jc-band-dot.higher { background: #8b5cf6; }
        .jc-band-dot.mastery { background: #f59e0b; }
        /* L2LP NCCA Band Dots */
        .jc-band-dot.developing { background: #3b82f6; }
        .jc-band-dot.progressing { background: #8b5cf6; }
        .jc-band-dot.consolidating { background: #f59e0b; }
        
        /* Topic Header */
        .unified-topic-header {
            background: var(--topic-gradient, linear-gradient(135deg, #f3f4f6, #e5e7eb));
            padding: 12px 14px;
            text-align: center;
            border-bottom: 2px solid var(--topic-color, #6b7280);
            position: relative;
            border-radius: 12px 12px 0 0;
        }
        
        .unified-topic-icon {
            font-size: 28px;
            margin-bottom: 4px;
        }
        
        .unified-topic-title {
            font-weight: 700;
            font-size: 14px;
            color: var(--topic-text, #374151);
        }
        
        .unified-mastery-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            box-shadow: 0 3px 8px rgba(255, 215, 0, 0.5);
            border: 2px solid white;
            z-index: 2;
        }
        
        /* Mode Options */
        .unified-mode-options {
            display: flex;
            flex-direction: column;
            flex: 1;
            overflow: visible;
        }
        
        .unified-mode-option {
            padding: 10px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f3f4f6;
            flex: 1;
            position: relative;
            overflow: visible;
        }
        
        /* JC Exam - PRIMARY/RECOMMENDED option */
        .unified-mode-option.adaptive {
            padding: 14px 12px;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            flex: 1.5;
            min-height: 90px;
        }
        
        .unified-mode-option.adaptive:not(.disabled) {
            border-left: 3px solid #f59e0b;
        }
        
        /* Practice - SECONDARY option */
        .unified-mode-option.practice {
            padding: 8px 12px;
            flex: 0.8;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .unified-mode-option.practice .unified-mode-icon {
            width: 26px;
            height: 26px;
            font-size: 10px;
        }
        
        .unified-mode-option.practice .unified-mode-label {
            font-size: 11px;
            color: #166534;
            font-weight: 500;
        }
        
        .unified-mode-option:last-child {
            border-bottom: none;
        }
        
        .unified-mode-option:hover:not(.disabled) {
            background: var(--hover-bg, #f9fafb);
        }
        
        .unified-mode-option.practice:hover:not(.disabled) {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            box-shadow: 0 2px 6px rgba(34, 197, 94, 0.15);
        }
        
        .unified-mode-option.adaptive:hover:not(.disabled) {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);
        }
        
        /* Disabled state */
        .unified-mode-option.disabled {
            opacity: 0.55;
            cursor: not-allowed;
            background: #f9fafb;
        }
        
        /* Disabled adaptive should still take same space */
        .unified-mode-option.adaptive.disabled {
            padding: 14px 12px;
            flex: 1.5;
            min-height: 90px;
        }
        
        /* Mode Icon */
        .unified-mode-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .unified-mode-icon.practice {
            background: linear-gradient(135deg, #86efac, #4ade80);
            color: #166534;
        }
        
        .unified-mode-icon.adaptive {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            width: 36px;
            height: 36px;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
        }
        
        /* Recommended Badge */
        .unified-recommended-badge {
            font-size: 9px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
            letter-spacing: 0.3px;
            text-transform: uppercase;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        /* SEC Aligned subtitle */
        .unified-mode-subtitle {
            font-size: 10px;
            color: #92400e;
            font-weight: 400;
            margin-top: 1px;
        }
        
        .unified-mode-icon.disabled {
            background: #e5e7eb;
            color: #9ca3af;
        }
        
        /* Mode Info */
        .unified-mode-info {
            flex: 1;
            min-width: 0;
        }
        
        .unified-mode-label {
            font-weight: 600;
            font-size: 12px;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .unified-coming-soon {
            font-size: 9px;
            background: #e5e7eb;
            color: #6b7280;
            padding: 1px 5px;
            border-radius: 8px;
            font-weight: 500;
        }
        
        /* Progress Indicators */
        .unified-mode-progress {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 3px;
        }
        
        /* Practice: Difficulty Dots - Smaller for secondary display */
        .unified-diff-dots {
            display: flex;
            gap: 2px;
        }
        
        .unified-diff-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 7px;
            font-weight: 700;
            border: 1px solid transparent;
        }
        
        .unified-diff-dot.beginner {
            background: #d1fae5;
            color: #059669;
            border-color: #a7f3d0;
        }
        
        .unified-diff-dot.intermediate {
            background: #fef3c7;
            color: #b45309;
            border-color: #fde68a;
        }
        
        .unified-diff-dot.advanced {
            background: #fee2e2;
            color: #dc2626;
            border-color: #fecaca;
        }
        
        .unified-diff-dot.complete {
            background: #10b981 !important;
            color: white !important;
            border-color: #059669 !important;
        }
        
        .unified-progress-text {
            font-size: 10px;
            color: #6b7280;
        }
        
        .unified-progress-text.mastered {
            color: #059669;
            font-weight: 600;
        }
        
        /* Adaptive: Level Progress - More Prominent */
        .unified-level-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .unified-level-bar {
            width: 60px;
            height: 6px;
            background: #fde68a;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .unified-level-fill {
            height: 100%;
            background: linear-gradient(90deg, #f59e0b, #d97706);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .unified-level-fill.mastered {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .unified-level-text {
            font-size: 10px;
            color: #92400e;
            font-weight: 600;
        }
        
        .unified-level-text.mastered {
            color: #059669;
            font-weight: 700;
        }
        
        /* Arrow */
        .unified-mode-arrow {
            color: #d1d5db;
            font-size: 10px;
            transition: transform 0.2s;
        }
        
        .unified-mode-option:hover:not(.disabled) .unified-mode-arrow {
            color: #9ca3af;
            transform: translateX(2px);
        }
        
        /* Numeracy Strand - Green/Teal Palette */
        .unified-topic-card[data-topic="whole_numbers"],
        .unified-topic-card[data-topic="addition_subtraction"],
        .unified-topic-card[data-topic="multiplication_skills"],
        .unified-topic-card[data-topic="division_skills"] {
            --topic-color: #10b981;
            --topic-gradient: linear-gradient(135deg, #d1fae5, #a7f3d0);
            --topic-text: #047857;
        }
        
        .unified-topic-card[data-topic="basic_fractions"],
        .unified-topic-card[data-topic="basic_decimals"],
        .unified-topic-card[data-topic="basic_percentages"],
        .unified-topic-card[data-topic="time_and_clocks"] {
            --topic-color: #14b8a6;
            --topic-gradient: linear-gradient(135deg, #ccfbf1, #99f6e4);
            --topic-text: #0f766e;
        }
        
        .unified-topic-card[data-topic="money_skills"],
        .unified-topic-card[data-topic="measurement"],
        .unified-topic-card[data-topic="data_and_charts"],
        .unified-topic-card[data-topic="number_patterns"] {
            --topic-color: #059669;
            --topic-gradient: linear-gradient(135deg, #d1fae5, #6ee7b7);
            --topic-text: #065f46;
        }
        
        /* L1LP Strand - Topic Cards (Purple palette) */
        .unified-topic-card[data-topic="awareness_of_environment"] {
            --topic-color: #8b5cf6;
            --topic-gradient: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            --topic-text: #6b21a8;
        }
        
        .unified-topic-card[data-topic="pattern_and_sequence"] {
            --topic-color: #7c3aed;
            --topic-gradient: linear-gradient(135deg, #ede9fe, #ddd6fe);
            --topic-text: #5b21b6;
        }
        
        .unified-topic-card[data-topic="developing_number_sense"] {
            --topic-color: #6d28d9;
            --topic-gradient: linear-gradient(135deg, #e9d5ff, #d8b4fe);
            --topic-text: #4c1d95;
        }
        
        .unified-topic-card[data-topic="shape_and_space"] {
            --topic-color: #5b21b6;
            --topic-gradient: linear-gradient(135deg, #ddd6fe, #c4b5fd);
            --topic-text: #4c1d95;
        }
        
        .unified-topic-card[data-topic="measure_and_data"] {
            --topic-color: #4c1d95;
            --topic-gradient: linear-gradient(135deg, #c4b5fd, #a78bfa);
            --topic-text: #3b0764;
        }
        
        .unified-topic-card[data-topic="time"] {
            --topic-color: #9333ea;
            --topic-gradient: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            --topic-text: #581c87;
        }
        
        /* L2LP Strand - Topic Cards (Orange palette - NCCA aligned) */
        .unified-topic-card[data-topic="l2_number_and_money"] {
            --topic-color: #f97316;
            --topic-gradient: linear-gradient(135deg, #fff7ed, #ffedd5);
            --topic-text: #9a3412;
        }
        
        .unified-topic-card[data-topic="l2_time_management"] {
            --topic-color: #ea580c;
            --topic-gradient: linear-gradient(135deg, #ffedd5, #fed7aa);
            --topic-text: #7c2d12;
        }
        
        .unified-topic-card[data-topic="l2_measurement_location"] {
            --topic-color: #dc2626;
            --topic-gradient: linear-gradient(135deg, #fef2f2, #fee2e2);
            --topic-text: #991b1b;
        }
        
        .unified-topic-card[data-topic="l2_shape_pattern_number"] {
            --topic-color: #c2410c;
            --topic-gradient: linear-gradient(135deg, #fed7aa, #fdba74);
            --topic-text: #7c2d12;
        }
        
        /* Topic Color Themes */
        .unified-topic-card[data-topic="fractions"] {
            --topic-color: #f59e0b;
            --topic-gradient: linear-gradient(135deg, #fef3c7, #fde68a);
            --topic-text: #92400e;
        }
        
        .unified-topic-card[data-topic="percentages"] {
            --topic-color: #10b981;
            --topic-gradient: linear-gradient(135deg, #d1fae5, #a7f3d0);
            --topic-text: #047857;
        }
        
        .unified-topic-card[data-topic="ratio"] {
            --topic-color: #8b5cf6;
            --topic-gradient: linear-gradient(135deg, #ede9fe, #ddd6fe);
            --topic-text: #6d28d9;
        }
        
        .unified-topic-card[data-topic="sets"] {
            --topic-color: #f97316;
            --topic-gradient: linear-gradient(135deg, #ffedd5, #fed7aa);
            --topic-text: #c2410c;
        }
        
        .unified-topic-card[data-topic="decimals"] {
            --topic-color: #14b8a6;
            --topic-gradient: linear-gradient(135deg, #ccfbf1, #99f6e4);
            --topic-text: #0f766e;
        }
        
        .unified-topic-card[data-topic="arithmetic"],
        .unified-topic-card[data-topic="integers"] {
            --topic-color: #3b82f6;
            --topic-gradient: linear-gradient(135deg, #dbeafe, #bfdbfe);
            --topic-text: #1e40af;
        }
        
        .unified-topic-card[data-topic="multiplication_division"],
        .unified-topic-card[data-topic="bodmas"] {
            --topic-color: #6366f1;
            --topic-gradient: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            --topic-text: #3730a3;
        }
        
        .unified-topic-card[data-topic="number_systems"] {
            --topic-color: #06b6d4;
            --topic-gradient: linear-gradient(135deg, #cffafe, #a5f3fc);
            --topic-text: #0e7490;
        }
        
        .unified-topic-card[data-topic="patterns"],
        .unified-topic-card[data-topic="introductory_algebra"],
        .unified-topic-card[data-topic="simplifying_expressions"],
        .unified-topic-card[data-topic="expanding_factorising"],
        .unified-topic-card[data-topic="functions"] {
            --topic-color: #8b5cf6;
            --topic-gradient: linear-gradient(135deg, #ede9fe, #ddd6fe);
            --topic-text: #5b21b6;
        }
        
        .unified-topic-card[data-topic="probability"] {
            --topic-color: #ec4899;
            --topic-gradient: linear-gradient(135deg, #fce7f3, #fbcfe8);
            --topic-text: #9d174d;
        }
        
        .unified-topic-card[data-topic="descriptive_statistics"] {
            --topic-color: #06b6d4;
            --topic-gradient: linear-gradient(135deg, #cffafe, #a5f3fc);
            --topic-text: #0e7490;
        }
        
        .unified-topic-card[data-topic="solving_equations"] {
            --topic-color: #6366f1;
            --topic-gradient: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            --topic-text: #4338ca;
        }
        
        .unified-topic-card[data-topic="surds"] {
            --topic-color: #a855f7;
            --topic-gradient: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            --topic-text: #7c3aed;
        }
        
        .unified-topic-card[data-topic="complex_numbers_intro"],
        .unified-topic-card[data-topic="complex_numbers_expanded"] {
            --topic-color: #d946ef;
            --topic-gradient: linear-gradient(135deg, #fae8ff, #f5d0fe);
            --topic-text: #a21caf;
        }
        
        .unified-topic-card[data-topic="applied_arithmetic"] {
            --topic-color: #059669;
            --topic-gradient: linear-gradient(135deg, #d1fae5, #a7f3d0);
            --topic-text: #047857;
        }
        
        .unified-topic-card[data-topic="currency"] {
            --topic-color: #0d9488;
            --topic-gradient: linear-gradient(135deg, #ccfbf1, #99f6e4);
            --topic-text: #0f766e;
        }
        
        .unified-topic-card[data-topic="speed_distance_time"] {
            --topic-color: #ea580c;
            --topic-gradient: linear-gradient(135deg, #ffedd5, #fed7aa);
            --topic-text: #c2410c;
        }
        
        /* Responsive for unified cards */
        @media (max-width: 768px) {
            .path-flow {
                flex-direction: column;
            }
            
            .unified-flow-arrow {
                transform: rotate(90deg);
                margin: 8px 0;
            }
            
            .unified-topic-card {
                min-width: 100%;
                max-width: 100%;
                width: 100%;
                height: auto;
                min-height: auto;
            }
            
            /* Keep popup on mobile but position differently */
            .jc-level-popup {
                width: 95vw;
                max-width: 380px;
                left: 50%;
                transform: translateX(-50%);
            }
        }

        .mastery-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 9999;
            text-align: center;
            animation: popIn 0.5s ease-out;
        }

        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        /* ==================== GUEST MODE STYLES ==================== */
        .guest-banner {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 16px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid #2f855a;
        }

        .guest-banner-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
        }

        .guest-banner-text {
            flex: 1;
            min-width: 250px;
        }

        .guest-banner h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .guest-banner p {
            margin: 0;
            font-size: 14px;
            opacity: 0.95;
        }

        .guest-banner-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .guest-register-btn {
            background: white;
            color: #38a169;
            padding: 10px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        .guest-register-btn:hover {
            background: #f7fafc;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .guest-login-btn {
            background: transparent;
            color: white;
            padding: 10px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            border: 2px solid white;
            cursor: pointer;
            font-size: 14px;
        }

        .guest-login-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        @media (max-width: 640px) {
            .guest-banner-content {
                flex-direction: column;
                text-align: center;
            }
            
            .guest-banner-actions {
                width: 100%;
                justify-content: center;
            }
        }

        /* Guest Result Modal Styles */
        .guest-result-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .guest-result-modal {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .guest-result-modal h2 {
            color: #2d3748;
            font-size: 28px;
            margin-bottom: 16px;
        }

        .guest-result-modal .score-display {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        .guest-result-modal .message {
            color: #4a5568;
            font-size: 16px;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .guest-result-modal .benefits {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .guest-result-modal .benefits h3 {
            color: #2d3748;
            font-size: 18px;
            margin-bottom: 12px;
        }

        .guest-result-modal .benefits ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .guest-result-modal .benefits li {
            color: #4a5568;
            padding: 6px 0;
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .guest-result-modal .benefits li::before {
            content: 'âœ“';
            color: #48bb78;
            font-weight: bold;
            margin-right: 10px;
            font-size: 18px;
        }

        .guest-result-modal .button-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .guest-result-modal .primary-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .guest-result-modal .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .guest-result-modal .secondary-btn {
            background: #e2e8f0;
            color: #2d3748;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .guest-result-modal .secondary-btn:hover {
            background: #cbd5e0;
        }

        /* ========================================
           AVATAR SYSTEM STYLES 
           ======================================== */
        
        @keyframes results-glow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            }
            50% {
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            }
        }
        
        #header-avatar-container:hover #header-avatar {
            transform: scale(1.1);
            transition: transform 0.2s ease;
        }
        
        #results-avatar {
            margin: 0 auto;
        }

        /* ========================================
           MILESTONE CELEBRATION SYSTEM 
           ======================================== */
        
        .milestone-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease-in;
        }

        .milestone-modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.5s ease-out;
            position: relative;
        }

        .milestone-modal.perfect-score {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .milestone-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out infinite;
        }

        .milestone-title {
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .milestone-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            margin-bottom: 30px;
        }

        .milestone-badges-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
            max-height: 400px;
            overflow-y: auto;
        }

        .milestone-badge {
            background: rgba(255, 255, 255, 1.0);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            /* backdrop-filter: blur(10px); */ /* REMOVED - CAUSED BLUR */
            transition: transform 0.2s;
        }

        .milestone-badge:hover {
            transform: scale(1.02);
        }

        .milestone-badge-icon {
            font-size: 40px;
            margin-bottom: 5px;
        }

        .milestone-badge-name {
            color: white;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .milestone-badge-description {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .milestone-badge-points {
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            margin-top: 8px;
        }

        .milestone-continue-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .milestone-continue-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            border-radius: 20px;
            overflow: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px) scale(0.8);
                opacity: 0;
            }
            to { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }

        /* Clock Challenge Animations (Rev 3.0) */
        @keyframes clockModalPop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes clockSuccessPop {
            0% { transform: scale(0.5) rotate(-5deg); opacity: 0; }
            50% { transform: scale(1.05) rotate(2deg); }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }

        @keyframes clockPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes clockBounce {
            0% { transform: translateY(-30px); opacity: 0; }
            50% { transform: translateY(10px); }
            100% { transform: translateY(0); opacity: 1; }
        }

        @keyframes clockFlash {
            0%, 100% { background: linear-gradient(135deg, #1e1b4b, #312e81); }
            50% { background: linear-gradient(135deg, #7f1d1d, #991b1b); }
        }

        @keyframes penaltyPop {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            30% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(0.8) translateY(-50px); opacity: 0; }
        }

        /* ========== FLOW SUMS STYLES ========== */
        .flow-sums-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .flow-sums-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .flow-sums-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .flow-sums-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        .flow-sums-level-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .flow-sums-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        .flow-sums-close:hover {
            transform: scale(1.1);
        }
        .flow-sums-game {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.2);
        }
        .flow-gateway {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }
        .flow-gateway-label { font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px; }
        .flow-gateway-number { font-size: 2.5rem; }
        .flow-steps-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
        }
        .flow-steps-container.layout-arrow_down { align-items: center; }
        .flow-steps-container.layout-arrow_down .flow-step { width: 100%; max-width: 350px; }
        .flow-steps-container.layout-arrow_up { align-items: center; flex-direction: column-reverse; }
        .flow-steps-container.layout-arrow_up .flow-step { width: 100%; max-width: 350px; }
        .flow-steps-container.layout-snake_right,
        .flow-steps-container.layout-snake_left {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        @media (max-width: 768px) {
            .flow-sums-container {
                padding: 10px;
            }
            .flow-sums-header {
                padding: 10px 15px;
                flex-wrap: wrap;
                gap: 10px;
            }
            .flow-sums-title {
                font-size: 1.1rem;
            }
            .flow-sums-game {
                padding: 15px;
            }
            .flow-equation {
                font-size: 1.3rem;
                padding: 12px 15px;
            }
            .flow-steps-container {
                gap: 10px;
            }
            .flow-steps-container.layout-snake_right,
            .flow-steps-container.layout-snake_left {
                grid-template-columns: 1fr;
            }
            .flow-steps-container.layout-arrow_down .flow-step,
            .flow-steps-container.layout-arrow_up .flow-step {
                max-width: 100%;
            }
            .flow-step {
                padding: 12px;
            }
            .flow-step-operation {
                font-size: 1.1rem;
            }
            .flow-step-input {
                font-size: 1.2rem;
                padding: 10px;
            }
            .flow-step-submit {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
            .flow-sums-stats {
                padding: 10px 15px;
            }
            .flow-stat-value {
                font-size: 1.2rem;
            }
        }
        @media (max-width: 480px) {
            .flow-sums-header {
                padding: 8px 12px;
            }
            .flow-sums-title {
                font-size: 1rem;
            }
            .flow-sums-game {
                padding: 10px;
            }
            .flow-equation {
                font-size: 1.1rem;
                padding: 10px 12px;
            }
            .flow-step {
                padding: 10px;
            }
            .flow-step-number {
                width: 24px;
                height: 24px;
                font-size: 0.75rem;
                top: -8px;
                left: -8px;
            }
            .flow-step-operation {
                font-size: 1rem;
            }
            .flow-step-input {
                font-size: 1.1rem;
                padding: 8px;
            }
            .flow-step-submit {
                padding: 8px 14px;
                font-size: 0.85rem;
            }
        }
        @media (max-width: 600px) {
            .flow-steps-container.layout-snake_right,
            .flow-steps-container.layout-snake_left {
                grid-template-columns: 1fr;
            }
        }
        .flow-step {
            background: #f8fafc;
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
            position: relative;
        }
        .flow-step.active {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
            background: #f0f4ff;
        }
        .flow-step.completed {
            border-color: #10b981;
            background: #ecfdf5;
        }
        .flow-step.incorrect {
            animation: flowShake 0.5s ease;
            border-color: #f97316;
            background: #fff7ed;
        }
        .flow-step.revealed {
            border-color: #8b5cf6;
            background: #f5f3ff;
        }
        @keyframes flowShake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .flow-step-number {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 28px;
            height: 28px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
        }
        .flow-step.completed .flow-step-number { background: #10b981; }
        .flow-step-operation {
            font-size: 1.1rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 10px;
            text-align: center;
        }
        .flow-step-input-area {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .flow-step-input {
            flex: 1;
            padding: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            text-align: center;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s;
        }
        .flow-step-input:focus { border-color: #667eea; }
        .flow-step-input:disabled { background: #f3f4f6; color: #6b7280; }
        .flow-step-input.correct { border-color: #10b981; background: #d1fae5; color: #065f46; }
        .flow-step-input.incorrect { border-color: #f97316; background: #ffedd5; }
        .flow-step-submit {
            padding: 12px 16px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }
        .flow-step-submit:hover { background: #5a67d8; }
        .flow-step-submit:disabled { background: #9ca3af; cursor: not-allowed; }
        .flow-hint-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 28px;
            height: 28px;
            background: #fbbf24;
            color: #92400e;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 700;
            transition: transform 0.2s;
        }
        .flow-hint-btn:hover { transform: scale(1.1); }
        .flow-hint-btn:disabled { background: #d1d5db; color: #6b7280; cursor: not-allowed; }
        .flow-hint-tooltip {
            position: absolute;
            top: 45px;
            right: 0;
            background: #1f2937;
            color: white;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 0.85rem;
            max-width: 200px;
            z-index: 10;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .flow-hint-tooltip.visible {
            display: block;
            animation: flowFadeIn 0.3s ease;
        }
        @keyframes flowFadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .flow-attempts { font-size: 0.75rem; color: #6b7280; text-align: center; margin-top: 5px; }
        .flow-attempts.warning { color: #f97316; font-weight: 600; }
        .flow-arrow { text-align: center; font-size: 1.5rem; color: #9ca3af; margin: 5px 0; }
        .flow-final-answer {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }
        .flow-final-label { font-size: 1rem; opacity: 0.9; margin-bottom: 8px; }
        .flow-final-value { font-size: 2rem; font-weight: 700; }
        .flow-final-value.pending { opacity: 0.5; }
        .flow-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .flow-celebration.active { display: flex; }
        .flow-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: flowPopIn 0.5s ease;
        }
        @keyframes flowPopIn {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        .flow-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .flow-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .flow-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .flow-celebration-points {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .flow-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .flow-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .flow-celebration-btn:hover { transform: scale(1.05); }
        .flow-celebration-btn.primary { background: #667eea; color: white; }
        .flow-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        .flow-progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        .flow-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        .flow-stats { display: flex; justify-content: space-around; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb; }
        .flow-stat { text-align: center; }
        .flow-stat-value { font-size: 1.3rem; font-weight: 700; color: #667eea; }
        .flow-stat-label { font-size: 0.75rem; color: #6b7280; }
        /* ========== END FLOW SUMS STYLES ========== */

        /* ========== NUMBER PYRAMIDS STYLES ========== */
        .pyramid-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .pyramid-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .pyramid-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .pyramid-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        .pyramid-level-badge {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .pyramid-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        .pyramid-close:hover { transform: scale(1.1); }
        .pyramid-game {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.2);
        }
        .pyramid-instructions {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1rem;
        }
        .pyramid-grid {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            margin: 20px 0;
        }
        .pyramid-row {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        .pyramid-cell {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 10px;
            position: relative;
            transition: all 0.3s ease;
        }
        .pyramid-cell.given {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.3);
        }
        .pyramid-cell.blank {
            background: #f8fafc;
            border: 3px solid #d1d5db;
            cursor: pointer;
        }
        .pyramid-cell.blank:hover {
            border-color: #f093fb;
            box-shadow: 0 0 0 3px rgba(240, 147, 251, 0.2);
        }
        .pyramid-cell.blank.active {
            border-color: #f5576c;
            box-shadow: 0 0 0 4px rgba(245, 87, 108, 0.3);
            background: #fef2f2;
        }
        .pyramid-cell.blank.correct {
            background: #d1fae5;
            border-color: #10b981;
            color: #065f46;
            cursor: default;
        }
        .pyramid-cell.blank.incorrect {
            animation: pyramidShake 0.5s ease;
            border-color: #f97316;
            background: #ffedd5;
        }
        .pyramid-cell.blank.revealed {
            background: #f5f3ff;
            border-color: #8b5cf6;
            color: #6d28d9;
            cursor: default;
        }
        @keyframes pyramidShake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-4px); }
            40%, 80% { transform: translateX(4px); }
        }
        .pyramid-cell input {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            color: #374151;
            outline: none;
        }
        .pyramid-cell input:disabled {
            color: inherit;
        }
        .pyramid-cell .hint-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 22px;
            height: 22px;
            background: #fbbf24;
            color: #92400e;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 700;
            display: none;
        }
        .pyramid-cell.blank.active .hint-btn,
        .pyramid-cell.blank:hover .hint-btn {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pyramid-input-area {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .pyramid-input-field {
            width: 120px;
            padding: 15px;
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            border: 3px solid #d1d5db;
            border-radius: 12px;
            outline: none;
        }
        .pyramid-input-field:focus {
            border-color: #f5576c;
        }
        .pyramid-submit-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .pyramid-submit-btn:hover { transform: scale(1.05); }
        .pyramid-submit-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        .pyramid-hint-text {
            text-align: center;
            color: #6b7280;
            font-size: 0.9rem;
            margin-top: 10px;
            min-height: 24px;
        }
        .pyramid-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
        }
        .pyramid-stat { text-align: center; }
        .pyramid-stat-value { font-size: 1.3rem; font-weight: 700; color: #f5576c; }
        .pyramid-stat-label { font-size: 0.75rem; color: #6b7280; }
        .pyramid-progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        .pyramid-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f093fb, #f5576c);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        /* Pyramid Celebration */
        .pyramid-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .pyramid-celebration.active { display: flex; }
        .pyramid-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: pyramidPopIn 0.5s ease;
        }
        @keyframes pyramidPopIn {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        .pyramid-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .pyramid-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .pyramid-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .pyramid-celebration-points {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .pyramid-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .pyramid-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .pyramid-celebration-btn:hover { transform: scale(1.05); }
        .pyramid-celebration-btn.primary { background: #f5576c; color: white; }
        .pyramid-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        @media (max-width: 500px) {
            .pyramid-cell { width: 48px; height: 48px; font-size: 1rem; }
            .pyramid-row { gap: 5px; }
        }
        /* ========== END NUMBER PYRAMIDS STYLES ========== */

        /* ========== CODE BREAKER STYLES ========== */
        .code-breaker-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 50%, #1e3a5f 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .code-breaker-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .code-breaker-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .code-breaker-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e3a5f;
        }
        .code-breaker-level-badge {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .code-breaker-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        .code-breaker-close:hover { transform: scale(1.1); }
        .code-breaker-game {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.3);
        }
        .code-breaker-clues {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .code-breaker-clues-title {
            font-weight: 700;
            color: #92400e;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        .code-breaker-clue {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 0;
            color: #78350f;
            font-size: 0.95rem;
        }
        .code-breaker-clue::before {
            content: "ðŸ’¡";
            font-size: 1rem;
        }
        .code-breaker-tip {
            background: #e0f2fe;
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 20px;
            color: #0369a1;
            font-size: 0.9rem;
            text-align: center;
        }
        .code-breaker-input-area {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .code-digit-input {
            width: 55px;
            height: 65px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            border: 3px solid #cbd5e1;
            border-radius: 12px;
            outline: none;
            transition: all 0.2s;
        }
        .code-digit-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .code-digit-input.correct {
            background: #22c55e;
            border-color: #16a34a;
            color: white;
        }
        .code-digit-input.wrong-position {
            background: #eab308;
            border-color: #ca8a04;
            color: white;
        }
        .code-digit-input.not-in-code {
            background: #6b7280;
            border-color: #4b5563;
            color: white;
        }
        .code-breaker-submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 20px;
        }
        .code-breaker-submit-btn:hover { transform: scale(1.02); }
        .code-breaker-submit-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        .code-breaker-history {
            background: #f8fafc;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        .code-breaker-history-title {
            font-weight: 600;
            color: #475569;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .code-history-row {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .code-history-row:last-child { border-bottom: none; }
        .code-history-digit {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border-radius: 6px;
            font-size: 1rem;
        }
        .code-history-digit.correct {
            background: #22c55e;
            color: white;
        }
        .code-history-digit.wrong-position {
            background: #eab308;
            color: white;
        }
        .code-history-digit.not-in-code {
            background: #6b7280;
            color: white;
        }
        .code-breaker-stats {
            display: flex;
            justify-content: space-around;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
        }
        .code-breaker-stat { text-align: center; }
        .code-breaker-stat-value { font-size: 1.3rem; font-weight: 700; color: #1e3a5f; }
        .code-breaker-stat-label { font-size: 0.75rem; color: #6b7280; }
        /* Code Breaker Celebration */
        .code-breaker-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .code-breaker-celebration.active { display: flex; }
        .code-breaker-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: codePopIn 0.5s ease;
        }
        @keyframes codePopIn {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        .code-breaker-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .code-breaker-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .code-breaker-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .code-breaker-celebration-points {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .code-breaker-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .code-breaker-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .code-breaker-celebration-btn:hover { transform: scale(1.05); }
        .code-breaker-celebration-btn.primary { background: #1e3a5f; color: white; }
        .code-breaker-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        .code-breaker-failed {
            background: #fef2f2;
            border: 2px solid #ef4444;
            border-radius: 12px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }
        .code-breaker-failed-title { color: #dc2626; font-weight: 700; margin-bottom: 5px; }
        .code-breaker-failed-code { font-size: 1.5rem; font-weight: 700; color: #1f2937; }
        @media (max-width: 400px) {
            .code-digit-input { width: 45px; height: 55px; font-size: 1.5rem; }
        }
        /* ========== END CODE BREAKER STYLES ========== */

        /* ========== MASTERING COUNTING STYLES ========== */
        .counting-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #065f46 0%, #059669 50%, #065f46 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .counting-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .counting-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .counting-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #065f46;
        }
        .counting-level-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .counting-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        .counting-close:hover { transform: scale(1.1); }
        .counting-game {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.3);
        }
        .counting-instruction {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: #065f46;
        }
        .counting-progress-bar {
            background: #e5e7eb;
            border-radius: 10px;
            height: 20px;
            margin-bottom: 20px;
            overflow: hidden;
            position: relative;
        }
        .counting-progress-fill {
            background: linear-gradient(90deg, #10b981, #059669);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
        }
        .counting-progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.75rem;
            font-weight: 700;
            color: #374151;
        }
        .counting-grid {
            margin-bottom: 20px;
        }
        .counting-row {
            display: flex;
            gap: 4px;
            margin-bottom: 12px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }
        .counting-row-number {
            width: 28px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #6b7280;
            font-size: 0.9rem;
        }
        .counting-cell {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            background: #f9fafb;
            color: #1f2937;
            transition: all 0.2s ease;
        }
        .counting-cell.hint {
            background: #e0f2fe;
            border-color: #0ea5e9;
            color: #0369a1;
        }
        .counting-cell-input {
            width: 45px;
            height: 45px;
            border: 3px solid #9ca3af;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            text-align: center;
            outline: none;
            transition: all 0.3s ease;
            background: white;
        }
        .counting-cell-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        .counting-cell-input.correct {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-color: #15803d;
            color: white;
            animation: countingCorrect 0.4s ease;
        }
        .counting-cell-input.incorrect {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #92400e;
        }
        @keyframes countingCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }
        .counting-row-complete {
            animation: rowComplete 0.5s ease;
        }
        @keyframes rowComplete {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-3px); }
            100% { transform: translateX(0); }
        }
        .counting-stats {
            display: flex;
            justify-content: space-around;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
        }
        .counting-stat { text-align: center; }
        .counting-stat-value { font-size: 1.3rem; font-weight: 700; color: #065f46; }
        .counting-stat-label { font-size: 0.75rem; color: #6b7280; }
        /* Counting Celebration */
        .counting-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .counting-celebration.active { display: flex; }
        .counting-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: countingPopIn 0.5s ease;
        }
        @keyframes countingPopIn {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }
        .counting-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .counting-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .counting-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .counting-celebration-points {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .counting-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .counting-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .counting-celebration-btn:hover { transform: scale(1.05); }
        .counting-celebration-btn.primary { background: #065f46; color: white; }
        .counting-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        /* Row celebration mini-toast */
        .counting-row-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 10002;
            opacity: 0;
            transition: all 0.3s ease;
        }
        .counting-row-toast.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        @media (max-width: 500px) {
            .counting-cell, .counting-cell-input { width: 38px; height: 38px; font-size: 0.95rem; }
            .counting-row-number { width: 22px; font-size: 0.8rem; }
        }
        @media (max-width: 400px) {
            .counting-cell, .counting-cell-input { width: 32px; height: 32px; font-size: 0.85rem; }
        }
        /* ========== END MASTERING COUNTING STYLES ========== */

        /* ========== WORDS TO NUMBERS STYLES ========== */
        .words-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 50%, #7c3aed 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .words-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .words-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .words-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #7c3aed;
        }
        .words-level-badge {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .words-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }
        .words-game {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.3);
        }
        /* Mode Selector */
        .words-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        .words-mode-btn {
            padding: 12px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        .words-mode-btn:hover { border-color: #a855f7; }
        .words-mode-btn.active {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            color: white;
            border-color: #7c3aed;
        }
        .words-instruction {
            background: linear-gradient(135deg, #f3e8ff, #e9d5ff);
            border: 2px solid #a855f7;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            color: #6b21a8;
        }
        .words-timer {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        .words-timer-item { text-align: center; }
        .words-timer-value { font-size: 1.5rem; font-weight: 700; color: #7c3aed; }
        .words-timer-label { font-size: 0.75rem; color: #6b7280; }
        .words-progress-bar {
            background: #e5e7eb;
            border-radius: 10px;
            height: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .words-progress-fill {
            background: linear-gradient(90deg, #a855f7, #7c3aed);
            height: 100%;
            transition: width 0.3s;
        }

        /* ===== CHAIN MODE ===== */
        .words-chain-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .words-chain-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .words-chain-item {
            padding: 12px 18px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 60px;
            text-align: center;
            user-select: none;
        }
        .words-chain-word {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            color: #92400e;
        }
        .words-chain-number {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 2px solid #3b82f6;
            color: #1e40af;
        }
        .words-chain-item:hover { transform: scale(1.05); }
        .words-chain-item.selected {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.4);
        }
        .words-chain-item.matched {
            background: linear-gradient(135deg, #22c55e, #16a34a) !important;
            border-color: #15803d !important;
            color: white !important;
            cursor: default;
            animation: chainMatch 0.4s ease;
        }
        @keyframes chainMatch {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        .words-chain-link {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        .words-chain-link-visual {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #f3e8ff;
            border-radius: 20px;
        }
        .words-chain-link-item {
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ===== JIGSAW MODE ===== */
        .words-jigsaw-area {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            min-height: 300px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            position: relative;
        }
        .words-jigsaw-piece {
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 700;
            cursor: grab;
            user-select: none;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            min-width: 80px;
            text-align: center;
        }
        .words-jigsaw-piece:active { cursor: grabbing; }
        .words-jigsaw-word {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            color: #92400e;
        }
        .words-jigsaw-number {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 3px solid #3b82f6;
            color: #1e40af;
        }
        .words-jigsaw-piece.dragging {
            opacity: 0.8;
            transform: scale(1.1) rotate(3deg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 100;
        }
        .words-jigsaw-piece.matched {
            background: linear-gradient(135deg, #22c55e, #16a34a) !important;
            border-color: #15803d !important;
            color: white !important;
            cursor: default;
            animation: jigsawSnap 0.5s ease;
        }
        @keyframes jigsawSnap {
            0% { transform: scale(1); }
            30% { transform: scale(1.2) rotate(5deg); }
            60% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        .words-jigsaw-dropzone {
            position: absolute;
            border: 3px dashed #a855f7;
            border-radius: 12px;
            padding: 15px 20px;
            background: rgba(168, 85, 247, 0.1);
            min-width: 100px;
            text-align: center;
            font-weight: 600;
            color: #7c3aed;
        }

        /* ===== BALLOON MODE ===== */
        .words-balloon-area {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            min-height: 350px;
            padding: 20px;
            background: linear-gradient(180deg, #e0f2fe, #bae6fd);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }
        .words-balloon {
            padding: 18px 22px;
            border-radius: 50%;
            font-weight: 700;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
            min-width: 70px;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            animation: balloonFloat 3s ease-in-out infinite;
        }
        .words-balloon::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 20px;
            background: #9ca3af;
        }
        .words-balloon-word {
            background: linear-gradient(135deg, #fcd34d, #f59e0b);
            border: 3px solid #d97706;
            color: #78350f;
        }
        .words-balloon-number {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            border: 3px solid #1d4ed8;
            color: white;
        }
        @keyframes balloonFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .words-balloon:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        .words-balloon.selected {
            transform: scale(1.15);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.5);
            animation: none;
        }
        .words-balloon.matched {
            animation: balloonPop 0.4s ease forwards;
        }
        @keyframes balloonPop {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }
        .words-balloon.wrong {
            animation: balloonWobble 0.4s ease;
        }
        @keyframes balloonWobble {
            0%, 100% { transform: rotate(0); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        /* Celebration */
        .words-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .words-celebration.active { display: flex; }
        .words-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: wordsPopIn 0.5s ease;
        }
        @keyframes wordsPopIn {
            0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }
        .words-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .words-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .words-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .words-celebration-points {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .words-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .words-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        .words-celebration-btn.primary { background: #7c3aed; color: white; }
        .words-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        /* ========== END WORDS TO NUMBERS STYLES ========== */

        /* ========== ORDERING & NUMBER LINES STYLES ========== */
        .ordering-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 50%, #0f766e 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .ordering-container.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .ordering-header {
            background: white;
            border-radius: 16px;
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .ordering-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #0f766e;
        }
        .ordering-level-badge {
            background: linear-gradient(135deg, #14b8a6, #0f766e);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }
        .ordering-close {
            background: #ef4444;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }
        .ordering-game {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 8px 40px rgba(0,0,0,0.3);
        }
        .ordering-instruction {
            background: linear-gradient(135deg, #ccfbf1, #99f6e4);
            border: 2px solid #14b8a6;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            color: #134e4a;
        }
        .ordering-progress-bar {
            background: #e5e7eb;
            border-radius: 10px;
            height: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .ordering-progress-fill {
            background: linear-gradient(90deg, #14b8a6, #0f766e);
            height: 100%;
            transition: width 0.3s;
        }

        /* ===== SORT MODE ===== */
        .ordering-sort-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
        }
        .ordering-sort-source {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            min-height: 70px;
            padding: 15px;
            background: #f0fdfa;
            border: 2px dashed #5eead4;
            border-radius: 12px;
        }
        .ordering-sort-target {
            display: flex;
            gap: 8px;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        .ordering-sort-slot {
            width: 70px;
            height: 70px;
            border: 3px dashed #cbd5e1;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #9ca3af;
            background: #f8fafc;
            transition: all 0.2s;
        }
        .ordering-sort-slot.filled {
            border-style: solid;
            border-color: #14b8a6;
            background: #ccfbf1;
            color: #0f766e;
        }
        .ordering-sort-slot.correct {
            border-color: #22c55e;
            background: #dcfce7;
            color: #16a34a;
        }
        .ordering-sort-slot.wrong {
            border-color: #ef4444;
            background: #fee2e2;
            color: #dc2626;
        }
        .ordering-sort-arrow {
            color: #14b8a6;
            font-size: 1.5rem;
        }
        .ordering-number-chip {
            padding: 15px 25px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            border-radius: 12px;
            font-size: 1.4rem;
            font-weight: 700;
            color: #92400e;
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
        }
        .ordering-number-chip:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .ordering-number-chip.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        .ordering-number-chip.placed {
            opacity: 0.3;
            cursor: default;
        }

        /* ===== NUMBER LINE MODE ===== */
        .ordering-line-area {
            padding: 20px 10px;
        }
        .ordering-numbers-to-place {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            margin-bottom: 30px;
            padding: 15px;
            background: #f0fdfa;
            border: 2px dashed #5eead4;
            border-radius: 12px;
        }
        .ordering-line-chip {
            padding: 12px 20px;
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 3px solid #f59e0b;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: #92400e;
            cursor: grab;
            user-select: none;
            transition: all 0.2s;
        }
        .ordering-line-chip.selected {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.4);
        }
        .ordering-line-chip.placed {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: #22c55e;
            color: #16a34a;
            cursor: default;
        }
        .ordering-numberline-wrapper {
            position: relative;
            padding: 60px 20px 40px;
        }
        .ordering-numberline {
            position: relative;
            height: 4px;
            background: #1f2937;
            border-radius: 2px;
            margin: 0 30px;
        }
        .ordering-numberline-tick {
            position: absolute;
            bottom: 0;
            width: 2px;
            height: 15px;
            background: #1f2937;
            transform: translateX(-50%);
        }
        .ordering-numberline-label {
            position: absolute;
            top: 20px;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: 600;
            color: #4b5563;
        }
        .ordering-placed-marker {
            position: absolute;
            top: -50px;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .ordering-placed-marker .marker-number {
            padding: 8px 14px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 8px;
            font-weight: 700;
            color: white;
            font-size: 1rem;
        }
        .ordering-placed-marker .marker-arrow {
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 10px solid #22c55e;
        }
        .ordering-placed-marker.wrong .marker-number {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        .ordering-placed-marker.wrong .marker-arrow {
            border-top-color: #ef4444;
        }
        .ordering-line-clickzone {
            position: absolute;
            top: -30px;
            left: 0;
            right: 0;
            height: 70px;
            cursor: crosshair;
        }
        .ordering-stats {
            display: flex;
            justify-content: space-around;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
            margin-top: 20px;
        }
        .ordering-stat { text-align: center; }
        .ordering-stat-value { font-size: 1.3rem; font-weight: 700; color: #0f766e; }
        .ordering-stat-label { font-size: 0.75rem; color: #6b7280; }

        /* Celebration */
        .ordering-celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
        }
        .ordering-celebration.active { display: flex; }
        .ordering-celebration-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: orderingPopIn 0.5s ease;
        }
        @keyframes orderingPopIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .ordering-celebration-emoji { font-size: 4rem; margin-bottom: 15px; }
        .ordering-celebration-title { font-size: 1.8rem; font-weight: 700; color: #1f2937; margin-bottom: 10px; }
        .ordering-celebration-subtitle { color: #6b7280; margin-bottom: 20px; }
        .ordering-celebration-points {
            background: linear-gradient(135deg, #14b8a6, #0f766e);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .ordering-celebration-buttons { display: flex; gap: 10px; justify-content: center; }
        .ordering-celebration-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }
        .ordering-celebration-btn.primary { background: #0f766e; color: white; }
        .ordering-celebration-btn.secondary { background: #e5e7eb; color: #374151; }
        /* ========== END ORDERING STYLES ========== */

        /* ========== NUMBER BONDS POP STYLES ========== */
        .bonds-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #ec4899 0%, #f472b6 50%, #ec4899 100%);
            z-index: 10000;
            display: none;
            overflow: hidden;
        }
        .bonds-container.active { display: flex; flex-direction: column; }
        .bonds-header {
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .bonds-title { font-size: 1.3rem; font-weight: 700; color: #be185d; }
        .bonds-target {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 1.5rem;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
        }
        .bonds-close {
            background: #ef4444; color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;
        }
        .bonds-game-area {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        .bonds-bubble {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s;
            animation: bubbleFloat 3s ease-in-out infinite;
            box-shadow: inset -5px -5px 15px rgba(0,0,0,0.1), inset 5px 5px 15px rgba(255,255,255,0.3);
        }
        .bonds-bubble.small { width: 60px; height: 60px; font-size: 1.1rem; }
        .bonds-bubble.medium { width: 75px; height: 75px; font-size: 1.3rem; }
        .bonds-bubble.large { width: 90px; height: 90px; font-size: 1.5rem; }
        .bonds-bubble.selected {
            transform: scale(1.15);
            box-shadow: 0 0 0 4px white, 0 0 20px rgba(255,255,255,0.5);
        }
        .bonds-bubble.popping {
            animation: bubblePop 0.3s ease-out forwards;
        }
        .bonds-bubble.wrong {
            animation: bubbleShake 0.4s ease;
        }
        @keyframes bubbleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        @keyframes bubblePop {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.5; }
            100% { transform: scale(0); opacity: 0; }
        }
        @keyframes bubbleShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .bonds-stats {
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
        }
        .bonds-stat { text-align: center; }
        .bonds-stat-value { font-size: 1.4rem; font-weight: 700; color: #be185d; }
        .bonds-stat-label { font-size: 0.75rem; color: #6b7280; }
        .bonds-celebration {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none; align-items: center; justify-content: center; z-index: 10001;
        }
        .bonds-celebration.active { display: flex; }
        .bonds-celebration-content {
            background: white; border-radius: 20px; padding: 40px; text-align: center; max-width: 400px;
        }
        @media (max-width: 768px) {
            .bonds-header { padding: 10px 15px; }
            .bonds-title { font-size: 1.1rem; }
            .bonds-target { padding: 8px 15px; font-size: 1.2rem; }
            .bonds-bubble.small { width: 50px; height: 50px; font-size: 0.95rem; }
            .bonds-bubble.medium { width: 60px; height: 60px; font-size: 1.1rem; }
            .bonds-bubble.large { width: 70px; height: 70px; font-size: 1.25rem; }
            .bonds-stats { padding: 10px 15px; }
            .bonds-stat-value { font-size: 1.2rem; }
            .bonds-celebration-content { padding: 25px; margin: 15px; }
        }
        /* ========== END NUMBER BONDS STYLES ========== */

        /* ========== PLACE VALUE BUILDER STYLES ========== */
        .placevalue-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 50%, #8b5cf6 100%);
            z-index: 10000;
            display: none;
            overflow-y: auto;
            padding: 20px;
        }
        .placevalue-container.active { display: flex; flex-direction: column; align-items: center; }
        .placevalue-header {
            background: white; border-radius: 16px; padding: 16px 24px; margin-bottom: 20px;
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; max-width: 700px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .placevalue-title { font-size: 1.4rem; font-weight: 700; color: #7c3aed; }
        .placevalue-level-badge {
            background: linear-gradient(135deg, #a78bfa, #7c3aed);
            color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600;
        }
        .placevalue-close {
            background: #ef4444; color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;
        }
        .placevalue-game {
            background: white; border-radius: 20px; padding: 25px;
            width: 100%; max-width: 700px; box-shadow: 0 8px 40px rgba(0,0,0,0.3);
        }
        .placevalue-clue {
            background: linear-gradient(135deg, #ede9fe, #ddd6fe);
            border: 2px solid #8b5cf6; border-radius: 12px; padding: 20px;
            margin-bottom: 25px; text-align: center;
            font-size: 1.2rem; font-weight: 600; color: #5b21b6;
        }
        .placevalue-columns {
            display: flex; justify-content: center; gap: 8px; margin-bottom: 25px; flex-wrap: wrap;
        }
        .placevalue-column {
            display: flex; flex-direction: column; align-items: center; min-width: 60px;
        }
        .placevalue-column-label {
            font-size: 0.7rem; font-weight: 600; color: #6b7280;
            margin-bottom: 8px; text-transform: uppercase;
        }
        .placevalue-slot {
            width: 55px; height: 65px;
            border: 3px dashed #c4b5fd; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; font-weight: 700; color: #9ca3af;
            background: #f5f3ff; transition: all 0.2s;
        }
        .placevalue-slot.filled {
            border-style: solid; border-color: #8b5cf6; background: #ede9fe; color: #5b21b6;
        }
        .placevalue-slot.correct { border-color: #22c55e; background: #dcfce7; color: #16a34a; }
        .placevalue-slot.wrong { border-color: #ef4444; background: #fee2e2; color: #dc2626; }
        .placevalue-slot.decimal-point {
            width: 20px; border: none; background: transparent; font-size: 3rem; color: #1f2937;
        }
        .placevalue-digits {
            display: flex; flex-wrap: wrap; gap: 12px; justify-content: center;
            padding: 20px; background: #f5f3ff; border-radius: 12px; margin-bottom: 20px;
        }
        .placevalue-digit {
            width: 55px; height: 55px;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border: 3px solid #d97706; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; font-weight: 700; color: white;
            cursor: grab; user-select: none; transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .placevalue-digit:hover { transform: scale(1.05); }
        .placevalue-digit.selected { box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.5); }
        .placevalue-digit.used { opacity: 0.3; cursor: default; }
        .placevalue-check-btn {
            width: 100%; padding: 15px; background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white; border: none; border-radius: 12px;
            font-size: 1.1rem; font-weight: 600; cursor: pointer;
        }
        .placevalue-check-btn:disabled { background: #d1d5db; cursor: not-allowed; }
        @media (max-width: 768px) {
            .placevalue-container { padding: 10px; }
            .placevalue-header { padding: 12px 16px; margin-bottom: 15px; }
            .placevalue-title { font-size: 1.1rem; }
            .placevalue-game { padding: 15px; }
            .placevalue-clue { font-size: 1rem; padding: 15px; margin-bottom: 20px; }
            .placevalue-columns { gap: 5px; }
            .placevalue-column { min-width: 45px; }
            .placevalue-column-label { font-size: 0.6rem; }
            .placevalue-slot { width: 45px; height: 55px; font-size: 1.6rem; }
            .placevalue-slot.decimal-point { width: 15px; font-size: 2.5rem; }
            .placevalue-digits { padding: 15px; gap: 8px; }
            .placevalue-digit { width: 45px; height: 45px; font-size: 1.5rem; }
        }
        @media (max-width: 480px) {
            .placevalue-clue { font-size: 0.9rem; padding: 12px; }
            .placevalue-slot { width: 38px; height: 48px; font-size: 1.4rem; border-width: 2px; }
            .placevalue-digit { width: 40px; height: 40px; font-size: 1.3rem; }
        }
        /* ========== END PLACE VALUE STYLES ========== */

        /* ========== DOUBLE TROUBLE STYLES ========== */
        .double-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 50%, #f59e0b 100%);
            z-index: 10000;
            display: none;
            overflow: hidden;
        }
        .double-container.active { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .double-header {
            position: absolute; top: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .double-title { font-size: 1.3rem; font-weight: 700; color: #b45309; }
        .double-progress { font-weight: 600; color: #92400e; }
        .double-close {
            background: #ef4444; color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;
        }
        .double-game {
            background: white; border-radius: 24px; padding: 40px;
            width: 90%; max-width: 500px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            text-align: center;
        }
        .double-timer-bar {
            height: 8px; background: #e5e7eb; border-radius: 4px; margin-bottom: 30px; overflow: hidden;
        }
        .double-timer-fill {
            height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a);
            transition: width 0.1s linear;
        }
        .double-timer-fill.warning { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .double-timer-fill.danger { background: linear-gradient(90deg, #ef4444, #dc2626); }
        .double-question {
            font-size: 2.5rem; font-weight: 700; color: #1f2937; margin-bottom: 30px;
        }
        .double-input {
            width: 100%; padding: 20px; font-size: 2rem; text-align: center;
            border: 3px solid #d1d5db; border-radius: 16px;
            margin-bottom: 20px; font-weight: 700;
        }
        .double-input:focus { outline: none; border-color: #f59e0b; }
        .double-input.correct { border-color: #22c55e; background: #dcfce7; }
        .double-input.wrong { border-color: #ef4444; background: #fee2e2; }
        .double-streak {
            font-size: 1.2rem; font-weight: 600; color: #92400e;
        }
        .double-stats {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-around;
        }
        .double-stat { text-align: center; }
        .double-stat-value { font-size: 1.4rem; font-weight: 700; color: #b45309; }
        .double-stat-label { font-size: 0.75rem; color: #6b7280; }
        .double-celebration {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none; align-items: center; justify-content: center; z-index: 10001;
        }
        .double-celebration.active { display: flex; }
        .double-celebration-content {
            background: white; border-radius: 20px; padding: 40px; text-align: center; max-width: 400px;
        }
        @media (max-width: 768px) {
            .double-header { padding: 10px 15px; }
            .double-title { font-size: 1.1rem; }
            .double-game { padding: 25px; width: 95%; }
            .double-question { font-size: 2rem; margin-bottom: 20px; }
            .double-input { font-size: 1.6rem; padding: 15px; }
            .double-stats { padding: 10px 15px; }
            .double-stat-value { font-size: 1.2rem; }
            .double-celebration-content { padding: 25px; margin: 15px; }
        }
        @media (max-width: 480px) {
            .double-game { padding: 20px; }
            .double-question { font-size: 1.6rem; }
            .double-input { font-size: 1.4rem; padding: 12px; }
        }
        /* ========== END DOUBLE TROUBLE STYLES ========== */

        /* ========== ADDITION BLITZ STYLES ========== */
        .addition-blitz-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #22c55e 0%, #4ade80 50%, #22c55e 100%);
            z-index: 10000;
            display: none;
            overflow: hidden;
        }
        .addition-blitz-container.active { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .addition-blitz-header {
            position: absolute; top: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .addition-blitz-title { font-size: 1.3rem; font-weight: 700; color: #166534; }
        .addition-blitz-progress { font-weight: 600; color: #15803d; }
        .addition-blitz-close {
            background: #ef4444; color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;
        }
        .addition-blitz-game {
            background: white; border-radius: 24px; padding: 40px;
            width: 90%; max-width: 500px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            text-align: center;
        }
        .addition-blitz-timer-bar {
            height: 8px; background: #e5e7eb; border-radius: 4px; margin-bottom: 30px; overflow: hidden;
        }
        .addition-blitz-timer-fill {
            height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a);
            transition: width 0.1s linear;
        }
        .addition-blitz-timer-fill.warning { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .addition-blitz-timer-fill.danger { background: linear-gradient(90deg, #ef4444, #dc2626); }
        .addition-blitz-question {
            font-size: 3rem; font-weight: 700; color: #1f2937; margin-bottom: 30px;
        }
        .addition-blitz-input {
            width: 100%; padding: 20px; font-size: 2rem; text-align: center;
            border: 3px solid #d1d5db; border-radius: 16px;
            margin-bottom: 20px; font-weight: 700;
        }
        .addition-blitz-input:focus { outline: none; border-color: #22c55e; }
        .addition-blitz-input.correct { border-color: #22c55e; background: #dcfce7; }
        .addition-blitz-input.wrong { border-color: #ef4444; background: #fee2e2; }
        .addition-blitz-streak {
            font-size: 1.2rem; font-weight: 600; color: #166534;
        }
        .addition-blitz-stats {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-around; align-items: center;
        }
        .addition-blitz-stat { text-align: center; }
        .addition-blitz-stat-value { font-size: 1.4rem; font-weight: 700; color: #166534; }
        .addition-blitz-stat-label { font-size: 0.75rem; color: #6b7280; }
        .addition-blitz-celebration {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none; align-items: center; justify-content: center; z-index: 10001;
        }
        .addition-blitz-celebration.active { display: flex; }
        .addition-blitz-celebration-content {
            background: white; border-radius: 20px; padding: 40px; text-align: center; max-width: 400px;
        }
        @media (max-width: 768px) {
            .addition-blitz-header { padding: 10px 15px; }
            .addition-blitz-title { font-size: 1.1rem; }
            .addition-blitz-game { padding: 25px; width: 95%; }
            .addition-blitz-question { font-size: 2.2rem; margin-bottom: 20px; }
            .addition-blitz-input { font-size: 1.6rem; padding: 15px; }
            .addition-blitz-stats { padding: 10px 15px; }
            .addition-blitz-stat-value { font-size: 1.2rem; }
            .addition-blitz-celebration-content { padding: 25px; margin: 15px; }
        }
        @media (max-width: 480px) {
            .addition-blitz-game { padding: 20px; }
            .addition-blitz-question { font-size: 1.8rem; }
            .addition-blitz-input { font-size: 1.4rem; padding: 12px; }
        }
        /* ========== END ADDITION BLITZ STYLES ========== */

        /* ========== TIMES TABLES BLITZ STYLES ========== */
        .times-tables-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 50%, #8b5cf6 100%);
            z-index: 10000;
            display: none;
            overflow: hidden;
        }
        .times-tables-container.active { display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .times-tables-header {
            position: absolute; top: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .times-tables-title { font-size: 1.3rem; font-weight: 700; color: #6d28d9; }
        .times-tables-progress { font-weight: 600; color: #7c3aed; }
        .times-tables-close {
            background: #ef4444; color: white; border: none;
            width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;
        }
        .times-tables-game {
            background: white; border-radius: 24px; padding: 40px;
            width: 90%; max-width: 500px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            text-align: center;
        }
        .times-tables-timer-bar {
            height: 8px; background: #e5e7eb; border-radius: 4px; margin-bottom: 30px; overflow: hidden;
        }
        .times-tables-timer-fill {
            height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a);
            transition: width 0.1s linear;
        }
        .times-tables-timer-fill.warning { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .times-tables-timer-fill.danger { background: linear-gradient(90deg, #ef4444, #dc2626); }
        .times-tables-question {
            font-size: 3rem; font-weight: 700; color: #1f2937; margin-bottom: 30px;
        }
        .times-tables-input {
            width: 100%; padding: 20px; font-size: 2rem; text-align: center;
            border: 3px solid #d1d5db; border-radius: 16px;
            margin-bottom: 20px; font-weight: 700;
        }
        .times-tables-input:focus { outline: none; border-color: #8b5cf6; }
        .times-tables-input.correct { border-color: #22c55e; background: #dcfce7; }
        .times-tables-input.wrong { border-color: #ef4444; background: #fee2e2; }
        .times-tables-streak {
            font-size: 1.2rem; font-weight: 600; color: #6d28d9;
        }
        .times-tables-stats {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            display: flex; justify-content: space-around; align-items: center;
        }
        .times-tables-stat { text-align: center; }
        .times-tables-stat-value { font-size: 1.4rem; font-weight: 700; color: #6d28d9; }
        .times-tables-stat-label { font-size: 0.75rem; color: #6b7280; }
        .times-tables-celebration {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none; align-items: center; justify-content: center; z-index: 10001;
        }
        .times-tables-celebration.active { display: flex; }
        .times-tables-celebration-content {
            background: white; border-radius: 20px; padding: 40px; text-align: center; max-width: 400px;
        }
        @media (max-width: 768px) {
            .times-tables-header { padding: 10px 15px; }
            .times-tables-title { font-size: 1.1rem; }
            .times-tables-game { padding: 25px; width: 95%; }
            .times-tables-question { font-size: 2.2rem; margin-bottom: 20px; }
            .times-tables-input { font-size: 1.6rem; padding: 15px; }
            .times-tables-stats { padding: 10px 15px; }
            .times-tables-stat-value { font-size: 1.2rem; }
            .times-tables-celebration-content { padding: 25px; margin: 15px; }
        }
        @media (max-width: 480px) {
            .times-tables-game { padding: 20px; }
            .times-tables-question { font-size: 1.8rem; }
            .times-tables-input { font-size: 1.4rem; padding: 12px; }
        }
        /* ========== END TIMES TABLES BLITZ STYLES ========== */



/* ============================================ */
/* CELEBRATION STYLES */
/* ============================================ */

        /* Password Modal Styles */
        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            /* backdrop-filter: blur(4px); */ /* REMOVED */
        }

        .password-modal.hidden {
            display: none;
        }

        .password-modal-content {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .password-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .password-modal-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 32px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .password-form {
            padding: 32px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-hint {
            display: block;
            margin-top: 6px;
            font-size: 12px;
            color: #718096;
        }

        .error-message {
            background: #fee;
            border: 2px solid #fcc;
            color: #c33;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .error-message::before {
            content: "âš ï¸";
            font-size: 18px;
        }

        .success-message {
            background: #efe;
            border: 2px solid #cfc;
            color: #3c3;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .success-message::before {
            content: "âœ“";
            font-size: 18px;
            font-weight: bold;
        }

        .error-message.hidden,
        .success-message.hidden {
            display: none;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .btn-cancel,
        .btn-submit {
            flex: 1;
            padding: 14px 24px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .btn-cancel {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-cancel:hover {
            background: #cbd5e0;
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        /* ========================================
           MILESTONE CELEBRATION SYSTEM 
           ======================================== */
        
        .milestone-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease-in;
        }

        .milestone-modal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.5s ease-out;
            position: relative;
        }

        .milestone-modal.perfect-score {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .milestone-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out infinite;
        }

        .milestone-title {
            color: white;
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .milestone-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            margin-bottom: 30px;
        }

        .milestone-badges-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
            max-height: 400px;
            overflow-y: auto;
        }

        .milestone-badge {
            background: rgba(255, 255, 255, 1.0);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            /* backdrop-filter: blur(10px); */ /* REMOVED - CAUSED BLUR */
            transition: transform 0.2s;
        }

        .milestone-badge:hover {
            transform: scale(1.02);
        }

        .milestone-badge-icon {
            font-size: 40px;
            margin-bottom: 5px;
        }

        .milestone-badge-name {
            color: white;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .milestone-badge-description {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .milestone-badge-points {
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            margin-top: 8px;
        }

        .milestone-continue-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .milestone-continue-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            border-radius: 20px;
            overflow: hidden;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px) scale(0.8);
                opacity: 0;
            }
            to { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }


/* ============================================ */
/* GRAPH PANEL STYLES */
/* ============================================ */

/* Tutorial Modal Styles */
#tutorialModal.flex {
    display: flex !important;
}

.tutorial-principle {
    background: white;
    border-left: 4px solid #9333ea;
    padding: 1rem;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.tutorial-example {
    background: #f0fdf4;
    border: 2px solid #86efac;
    border-radius: 0.75rem;
    padding: 1.25rem;
}

.tutorial-example-question {
    font-weight: 600;
    color: #047857;
    margin-bottom: 0.75rem;
    font-size: 1.1rem;
}

.tutorial-example-steps {
    background: white;
    padding: 1rem;
    border-radius: 0.5rem;
    margin: 0.75rem 0;
}

.tutorial-example-step {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    color: #374151;
}

.tutorial-example-step:before {
    content: "â†’";
    position: absolute;
    left: 0;
    color: #9333ea;
    font-weight: bold;
}

.tutorial-example-answer {
    background: #dcfce7;
    padding: 0.75rem;
    border-radius: 0.5rem;
    font-weight: 700;
    color: #047857;
    text-align: center;
    font-size: 1.1rem;
}

.tutorial-tip {
    padding: 0.75rem;
    padding-left: 2.5rem;
    background: white;
    border-radius: 0.5rem;
    position: relative;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.tutorial-tip:before {
    content: attr(data-icon);
    position: absolute;
    left: 0.75rem;
    font-size: 1.2rem;
}

/* Floating Help Button Animation */
#tutorialHelpBtn {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.05);
    }
}

/* Responsive */
@media (max-width: 768px) {
    #tutorialModal > div {
        max-width: 100%;
        margin: 1rem;
    }
}

/* ============================================ */
/* MODAL STYLES */
/* ============================================ */

/* Feedback button styling */
#feedback-button {
    max-width: 70px;
    overflow: visible;
}

/* Mobile: Smaller feedback button */
@media (max-width: 768px) {
    #feedback-button {
        bottom: 80px;
        left: 8px;
    }
    #feedback-button button {
        padding: 12px;
    }
    #feedback-button i {
        font-size: 1.25rem;
    }
}

/* Star rating hover effect */
.feedback-star {
    cursor: pointer;
    transition: transform 0.1s, color 0.2s;
}
.feedback-star:hover {
    transform: scale(1.2);
}
.feedback-star.active {
    color: #facc15 !important; /* yellow-400 */
}

/* ============================================ */
/* COMPONENT STYLES */
/* ============================================ */

/* Prevent puzzle indicator from affecting page width */
#puzzle-indicator {
    max-width: 70px;
    overflow: visible;
}

/* Mobile: Smaller puzzle button */
@media (max-width: 768px) {
    #puzzle-indicator {
        bottom: 80px;
        right: 8px;
    }
    #puzzle-indicator button {
        padding: 12px;
    }
    #puzzle-indicator i {
        font-size: 1.25rem;
    }
}

/* Puzzle popup mobile responsive */
@media (max-width: 640px) {
    #puzzle-splash-modal > div,
    #puzzle-answer-modal > div {
        max-width: 95vw !important;
        max-height: 90vh !important;
        overflow-y: auto;
        margin: 10px;
    }
    #puzzle-splash-modal .p-6,
    #puzzle-answer-modal .p-6 {
        padding: 1rem !important;
    }
    #puzzle-splash-modal h2,
    #puzzle-answer-modal h2 {
        font-size: 1.25rem !important;
    }
    #puzzle-splash-modal i.text-5xl,
    #puzzle-answer-modal i.text-5xl {
        font-size: 2.5rem !important;
    }
    #splash-puzzle-content,
    #answer-puzzle-content {
        min-height: auto !important;
        padding: 0.75rem !important;
    }
}

/* ============================================ */
/* ANIMATION STYLES */
/* ============================================ */

    @keyframes bounce-in {
        0% { transform: scale(0.9); opacity: 0; }
        50% { transform: scale(1.02); }
        100% { transform: scale(1); opacity: 1; }
    }
    .animate-bounce-in {
        animation: bounce-in 0.3s ease-out;
    }

